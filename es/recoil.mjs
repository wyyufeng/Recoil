import reactDom from"react-dom";import react from"react";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread2(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _construct(Parent,args,Class){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance}).apply(null,arguments)}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(Class){if(null===Class||(fn=Class,-1===Function.toString.call(fn).indexOf("[native code]")))return Class;var fn;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)})(Class)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _possibleConstructorReturn(self,call){return!call||"object"!=typeof call&&"function"!=typeof call?_assertThisInitialized(self):call}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(e){didErr=!0,err=e},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}var gkx=require("../util/Recoil_gkx"),nullthrows=require("../util/Recoil_nullthrows"),recoverableViolation=require("../util/Recoil_recoverableViolation"),Tracing=require("../util/Recoil_Tracing"),_require=require("./Recoil_FunctionalCore"),getDownstreamNodes=_require.getDownstreamNodes,getNodeLoadable=_require.getNodeLoadable,setNodeValue=_require.setNodeValue,saveDependencyMapToStore=require("./Recoil_Graph").saveDependencyMapToStore,getNodeMaybe=require("./Recoil_Node").getNodeMaybe,_require4=require("./Recoil_Node"),DefaultValue=_require4.DefaultValue,RecoilValueNotReady=_require4.RecoilValueNotReady,_require5=require("./Recoil_RecoilValue"),AbstractRecoilValue=_require5.AbstractRecoilValue,RecoilState=_require5.RecoilState,RecoilValueReadOnly=_require5.RecoilValueReadOnly,isRecoilValue=_require5.isRecoilValue;function applyAction(store,state,action){if("set"===action.type){var recoilValue=action.recoilValue,newValue=function(store,state,_ref2,valueOrUpdater){var key=_ref2.key;if("function"==typeof valueOrUpdater){var current=getNodeLoadable(store,state,key)[1];if("loading"===current.state)throw new RecoilValueNotReady(key);if("hasError"===current.state)throw current.contents;return valueOrUpdater(current.contents)}return valueOrUpdater}(store,state,recoilValue,action.valueOrUpdater),_setNodeValue2=_slicedToArray(setNodeValue(store,state,recoilValue.key,newValue),2),depMap=_setNodeValue2[0],writes=_setNodeValue2[1];saveDependencyMapToStore(depMap,store,state.version);var _step,_iterator=_createForOfIteratorHelper(writes.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2);writeLoadableToTreeState(state,_step$value[0],_step$value[1])}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else if("setLoadable"===action.type){writeLoadableToTreeState(state,action.recoilValue.key,action.loadable)}else if("markModified"===action.type){var _key2=action.recoilValue.key;state.dirtyAtoms.add(_key2)}else if("setUnvalidated"===action.type){var _node$invalidate,_key3=action.recoilValue.key,unvalidatedValue=action.unvalidatedValue,node=getNodeMaybe(_key3);null==node||null===(_node$invalidate=node.invalidate)||void 0===_node$invalidate||_node$invalidate.call(node,state),state.atomValues.delete(_key3),state.nonvalidatedAtoms.set(_key3,unvalidatedValue),state.dirtyAtoms.add(_key3)}else recoverableViolation("Unknown action ".concat(action.type),"recoil")}function writeLoadableToTreeState(state,key,loadable){"hasValue"===loadable.state&&loadable.contents instanceof DefaultValue?state.atomValues.delete(key):state.atomValues.set(key,loadable),state.dirtyAtoms.add(key),state.nonvalidatedAtoms.delete(key)}function applyActionsToStore(store,actions){store.replaceState((function(state){var _step2,newState=function(state){return _objectSpread2(_objectSpread2({},state),{},{atomValues:state.atomValues.clone(),nonvalidatedAtoms:state.nonvalidatedAtoms.clone(),dirtyAtoms:new Set(state.dirtyAtoms)})}(state),_iterator2=_createForOfIteratorHelper(actions);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var action=_step2.value;applyAction(store,newState,action)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return invalidateDownstreams(store,newState),newState}))}function queueOrPerformStateUpdate(store,action,key,message){if(batchStack.length){var actionsByStore=batchStack[batchStack.length-1],actions=actionsByStore.get(store);actions||actionsByStore.set(store,actions=[]),actions.push(action)}else Tracing.trace(message,key,(function(){return applyActionsToStore(store,[action])}))}var batchStack=[];function invalidateDownstreams(store,state){var _step4,_iterator4=_createForOfIteratorHelper(getDownstreamNodes(store,state,state.dirtyAtoms));try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _getNodeMaybe,_getNodeMaybe$invalid,key=_step4.value;null===(_getNodeMaybe=getNodeMaybe(key))||void 0===_getNodeMaybe||null===(_getNodeMaybe$invalid=_getNodeMaybe.invalidate)||void 0===_getNodeMaybe$invalid||_getNodeMaybe$invalid.call(_getNodeMaybe,state)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}function setRecoilValue(store,recoilValue,valueOrUpdater){queueOrPerformStateUpdate(store,{type:"set",recoilValue:recoilValue,valueOrUpdater:valueOrUpdater},recoilValue.key,"set Recoil value")}var subscriptionID=0;module.exports={RecoilValueReadOnly:RecoilValueReadOnly,AbstractRecoilValue:AbstractRecoilValue,RecoilState:RecoilState,getRecoilValueAsLoadable:function(store,_ref){var _storeState$nextTree,_storeState$previousT,key=_ref.key,treeState=arguments.length>2&&void 0!==arguments[2]?arguments[2]:store.getState().currentTree,storeState=store.getState();treeState.version!==storeState.currentTree.version&&treeState.version!==(null===(_storeState$nextTree=storeState.nextTree)||void 0===_storeState$nextTree?void 0:_storeState$nextTree.version)&&treeState.version!==(null===(_storeState$previousT=storeState.previousTree)||void 0===_storeState$previousT?void 0:_storeState$previousT.version)&&recoverableViolation("Tried to read from a discarded tree","recoil");var _getNodeLoadable=getNodeLoadable(store,treeState,key),_getNodeLoadable2=_slicedToArray(_getNodeLoadable,2),dependencyMap=_getNodeLoadable2[0],loadable=_getNodeLoadable2[1];return gkx("recoil_async_selector_refactor")||saveDependencyMapToStore(dependencyMap,store,treeState.version),loadable},setRecoilValue:setRecoilValue,setRecoilValueLoadable:function(store,recoilValue,loadable){if(loadable instanceof DefaultValue)return setRecoilValue(store,recoilValue,loadable);queueOrPerformStateUpdate(store,{type:"setLoadable",recoilValue:recoilValue,loadable:loadable},recoilValue.key,"set Recoil value")},markRecoilValueModified:function(store,recoilValue){queueOrPerformStateUpdate(store,{type:"markModified",recoilValue:recoilValue},recoilValue.key,"mark RecoilValue modified")},setUnvalidatedRecoilValue:function(store,recoilValue,unvalidatedValue){queueOrPerformStateUpdate(store,{type:"setUnvalidated",recoilValue:recoilValue,unvalidatedValue:unvalidatedValue},recoilValue.key,"set Recoil value")},subscribeToRecoilValue:function(store,_ref3,callback){var key=_ref3.key,componentDebugName=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,subID=subscriptionID++,storeState=store.getState();return storeState.nodeToComponentSubscriptions.has(key)||storeState.nodeToComponentSubscriptions.set(key,new Map),nullthrows(storeState.nodeToComponentSubscriptions.get(key)).set(subID,[null!=componentDebugName?componentDebugName:"<not captured>",callback]),{release:function(){var storeState=store.getState(),subs=storeState.nodeToComponentSubscriptions.get(key);void 0!==subs&&subs.has(subID)?(subs.delete(subID),0===subs.size&&storeState.nodeToComponentSubscriptions.delete(key)):recoverableViolation("Subscription missing at release time for atom ".concat(key,". This is a bug in Recoil."),"recoil")}}},isRecoilValue:isRecoilValue,applyAtomValueWrites:function(atomValues,writes){var result=atomValues.clone();return writes.forEach((function(v,k){"hasValue"===v.state&&v.contents instanceof DefaultValue?result.delete(k):result.set(k,v)})),result},batchStart:function(){var actionsByStore=new Map;return batchStack.push(actionsByStore),function(){var _step3,_iterator3=_createForOfIteratorHelper(actionsByStore);try{var _loop=function(){var _step3$value=_slicedToArray(_step3.value,2),store=_step3$value[0],actions=_step3$value[1];Tracing.trace("Recoil batched updates","-",(function(){return applyActionsToStore(store,actions)}))};for(_iterator3.s();!(_step3=_iterator3.n()).done;)_loop()}catch(err){_iterator3.e(err)}finally{_iterator3.f()}batchStack.pop()!==actionsByStore&&recoverableViolation("Incorrect order of batch popping","recoil")}},invalidateDownstreams_FOR_TESTING:invalidateDownstreams};var Recoil_RecoilValueInterface=Object.freeze({__proto__:null}),Recoil_ReactBatchedUpdates={unstable_batchedUpdates:{unstable_batchedUpdates:reactDom.unstable_batchedUpdates}.unstable_batchedUpdates},batchStart$1=Recoil_RecoilValueInterface.batchStart,batcher=Recoil_ReactBatchedUpdates.unstable_batchedUpdates,Recoil_Batching_setBatcher=function(newBatcher){batcher=newBatcher},Recoil_Batching_batchUpdates=function(callback){batcher((function(){var batchEnd=function(){};try{batchEnd=batchStart$1(),callback()}finally{batchEnd()}}))},mapIterable=(require("../util/Recoil_expectationViolation"),require("../util/Recoil_mapIterable")),nullthrows$1=require("../util/Recoil_nullthrows"),RecoilValueClasses=(require("../util/Recoil_recoverableViolation"),require("./Recoil_RecoilValue")),DefaultValue$1=function DefaultValue(){_classCallCheck(this,DefaultValue)},DEFAULT_VALUE=new DefaultValue$1,RecoilValueNotReady$1=function(_Error){_inherits(RecoilValueNotReady,_wrapNativeSuper(Error));var _super=_createSuper(RecoilValueNotReady);function RecoilValueNotReady(key){return _classCallCheck(this,RecoilValueNotReady),_super.call(this,"Tried to set the value of Recoil selector ".concat(key," using an updater function, but it is an async selector in a pending or error state; this is not supported."))}return RecoilValueNotReady}(),nodes=new Map,recoilValues=new Map;var NodeMissingError=function(_Error2){_inherits(NodeMissingError,_wrapNativeSuper(Error));var _super2=_createSuper(NodeMissingError);function NodeMissingError(){return _classCallCheck(this,NodeMissingError),_super2.apply(this,arguments)}return NodeMissingError}();module.exports={nodes:nodes,recoilValues:recoilValues,registerNode:function(node){if(nodes.has(node.key)){var message='Duplicate atom key "'.concat(node.key,'". This is a FATAL ERROR in\n      production. But it is safe to ignore this warning if it occurred because of\n      hot module replacement.');console.warn(message)}nodes.set(node.key,node);var recoilValue=null==node.set?new RecoilValueClasses.RecoilValueReadOnly(node.key):new RecoilValueClasses.RecoilState(node.key);return recoilValues.set(node.key,recoilValue),recoilValue},getNode:function(key){var node=nodes.get(key);if(null==node)throw new NodeMissingError('Missing definition for RecoilValue: "'.concat(key,'""'));return node},getNodeMaybe:function(key){return nodes.get(key)},recoilValuesForKeys:function(keys){return mapIterable(keys,(function(key){return nullthrows$1(recoilValues.get(key))}))},NodeMissingError:NodeMissingError,DefaultValue:DefaultValue$1,DEFAULT_VALUE:DEFAULT_VALUE,RecoilValueNotReady:RecoilValueNotReady$1};var Recoil_Node=Object.freeze({__proto__:null}),React=require("react"),_require$1=require("react"),useContext=_require$1.useContext,useEffect=_require$1.useEffect,useMemo=_require$1.useMemo,useRef=_require$1.useRef,useState=_require$1.useState,Queue=require("../adt/Recoil_Queue"),_require2$1=require("../core/Recoil_State"),getNextTreeStateVersion=_require2$1.getNextTreeStateVersion,makeEmptyStoreState=_require2$1.makeEmptyStoreState,expectationViolation$1=(require("../util/Recoil_CopyOnWrite").mapByDeletingMultipleFromMap,require("../util/Recoil_expectationViolation")),nullthrows$2=require("../util/Recoil_nullthrows"),Tracing$1=require("../util/Recoil_Tracing"),unionSets=require("../util/Recoil_unionSets"),_require4$1=require("./Recoil_FunctionalCore"),cleanUpNode=_require4$1.cleanUpNode,getDownstreamNodes$1=_require4$1.getDownstreamNodes,setNodeValue$1=_require4$1.setNodeValue,setUnvalidatedAtomValue_DEPRECATED=_require4$1.setUnvalidatedAtomValue_DEPRECATED,_require5$1=require("./Recoil_Graph"),graph=_require5$1.graph,saveDependencyMapToStore$1=_require5$1.saveDependencyMapToStore,cloneGraph=require("./Recoil_Graph").cloneGraph,applyAtomValueWrites$1=require("./Recoil_RecoilValueInterface").applyAtomValueWrites,freshSnapshot=require("./Recoil_Snapshot").freshSnapshot;function notInAContext(){throw new Error("This component must be used inside a <RecoilRoot> component.")}var defaultStore=Object.freeze({getState:notInAContext,replaceState:notInAContext,getGraph:notInAContext,subscribeToTransactions:notInAContext,addTransactionMetadata:notInAContext}),stateReplacerIsBeingExecuted=!1;function startNextTreeIfNeeded(storeState){if(stateReplacerIsBeingExecuted)throw new Error("An atom update was triggered within the execution of a state updater function. State updater functions provided to Recoil must be pure functions.");if(null===storeState.nextTree){var version=storeState.currentTree.version,nextVersion=getNextTreeStateVersion();storeState.nextTree=_objectSpread2(_objectSpread2({},storeState.currentTree),{},{version:nextVersion,stateID:nextVersion,dirtyAtoms:new Set,transactionMetadata:{}}),storeState.graphsByVersion.set(nextVersion,cloneGraph(nullthrows$2(storeState.graphsByVersion.get(version))))}}var AppContext=React.createContext({current:defaultStore}),useStoreRef=function(){return useContext(AppContext)},MutableSourceContext=React.createContext(null);function sendEndOfBatchNotifications(store){var storeState=store.getState(),treeState=storeState.currentTree,dirtyAtoms=treeState.dirtyAtoms;if(dirtyAtoms.size){var _step,_iterator=_createForOfIteratorHelper(storeState.nodeTransactionSubscriptions);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),key=_step$value[0],subscriptions=_step$value[1];if(dirtyAtoms.has(key)){var _step4,_iterator4=_createForOfIteratorHelper(subscriptions);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _step4$value=_slicedToArray(_step4.value,2);_step4$value[0];(0,_step4$value[1])(store)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,_iterator2=_createForOfIteratorHelper(storeState.transactionSubscriptions);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_slicedToArray(_step2.value,2);_step2$value[0];(0,_step2$value[1])(store)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var _step3,_iterator3=_createForOfIteratorHelper(getDownstreamNodes$1(store,treeState,dirtyAtoms));try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _key=_step3.value,comps=storeState.nodeToComponentSubscriptions.get(_key);if(comps){var _step5,_iterator5=_createForOfIteratorHelper(comps);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _step5$value=_slicedToArray(_step5.value,2),_step5$value$=(_step5$value[0],_slicedToArray(_step5$value[1],2));_step5$value$[0];(0,_step5$value$[1])(treeState)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}storeState.suspendedComponentResolvers.forEach((function(cb){return Tracing$1.trace("value became available, waking components","[available in dev build]",cb)}))}storeState.queuedComponentCallbacks_DEPRECATED.forEach((function(cb){return cb(treeState)})),storeState.queuedComponentCallbacks_DEPRECATED.splice(0,storeState.queuedComponentCallbacks_DEPRECATED.length)}function Batcher(props){var storeRef=useStoreRef(),_useState2=_slicedToArray(useState([]),2),setState=(_useState2[0],_useState2[1]);return props.setNotifyBatcherOfChange((function(){return setState({})})),useEffect((function(){Queue.enqueueExecution("Batcher",(function(){var storeState=storeRef.current.getState(),nextTree=storeState.nextTree;if(null!==nextTree){storeState.previousTree=storeState.currentTree,storeState.currentTree=nextTree,storeState.nextTree=null,sendEndOfBatchNotifications(storeRef.current);var discardedVersion=nullthrows$2(storeState.previousTree).version;storeState.graphsByVersion.delete(discardedVersion),storeState.previousTree=null}}))})),null}var nextID=0;module.exports={useStoreRef:useStoreRef,useRecoilMutableSource:function(){var mutableSource=useContext(MutableSourceContext);return null==mutableSource&&expectationViolation$1("Attempted to use a Recoil hook outside of a <RecoilRoot>. <RecoilRoot> must be an ancestor of any component that uses Recoil hooks."),mutableSource},RecoilRoot:function(_ref){var _createMutableSource,storeState,initializeState_DEPRECATED=_ref.initializeState_DEPRECATED,initializeState=_ref.initializeState,storeProp=_ref.store_INTERNAL,children=_ref.children,notifyBatcherOfChange=useRef(null),createMutableSource=null!==(_createMutableSource=React.createMutableSource)&&void 0!==_createMutableSource?_createMutableSource:React.unstable_createMutableSource,store=null!=storeProp?storeProp:{getState:function(){return storeState.current},replaceState:function(replacer){var storeState=storeRef.current.getState();startNextTreeIfNeeded(storeState);var replaced,nextTree=nullthrows$2(storeState.nextTree);try{stateReplacerIsBeingExecuted=!0,replaced=replacer(nextTree)}finally{stateReplacerIsBeingExecuted=!1}replaced!==nextTree&&(storeState.nextTree=replaced,nullthrows$2(notifyBatcherOfChange.current)())},getGraph:function(version){var graphs=storeState.current.graphsByVersion;if(graphs.has(version))return nullthrows$2(graphs.get(version));var newGraph=graph();return graphs.set(version,newGraph),newGraph},subscribeToTransactions:function(callback,key){if(null==key){var transactionSubscriptions=storeRef.current.getState().transactionSubscriptions,id=nextID++;return transactionSubscriptions.set(id,callback),{release:function(){transactionSubscriptions.delete(id)}}}var nodeTransactionSubscriptions=storeRef.current.getState().nodeTransactionSubscriptions;nodeTransactionSubscriptions.has(key)||nodeTransactionSubscriptions.set(key,new Map);var _id=nextID++;return nullthrows$2(nodeTransactionSubscriptions.get(key)).set(_id,callback),{release:function(){var subs=nodeTransactionSubscriptions.get(key);subs&&(subs.delete(_id),0===subs.size&&nodeTransactionSubscriptions.delete(key))}}},addTransactionMetadata:function(metadata){startNextTreeIfNeeded(storeRef.current.getState());for(var _i=0,_Object$keys=Object.keys(metadata);_i<_Object$keys.length;_i++){var k=_Object$keys[_i];nullthrows$2(storeRef.current.getState().nextTree).transactionMetadata[k]=metadata[k]}}},storeRef=useRef(store);storeState=useRef(null!=initializeState_DEPRECATED?function(store,initializeState){var initial=makeEmptyStoreState();return initializeState({set:function(atom,value){var state=initial.currentTree,_setNodeValue2=_slicedToArray(setNodeValue$1(store,state,atom.key,value),2),depMap=_setNodeValue2[0],writes=_setNodeValue2[1],writtenNodes=new Set(writes.keys());saveDependencyMapToStore$1(depMap,store,state.version);var _step6,nonvalidatedAtoms=state.nonvalidatedAtoms.clone(),_iterator6=_createForOfIteratorHelper(writtenNodes);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var n=_step6.value;nonvalidatedAtoms.delete(n)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}initial.currentTree=_objectSpread2(_objectSpread2({},state),{},{dirtyAtoms:unionSets(state.dirtyAtoms,writtenNodes),atomValues:applyAtomValueWrites$1(state.atomValues,writes),nonvalidatedAtoms:nonvalidatedAtoms})},setUnvalidatedAtomValues:function(atomValues){atomValues.forEach((function(v,k){initial.currentTree=setUnvalidatedAtomValue_DEPRECATED(initial.currentTree,k,v)}))}}),initial}(store,initializeState_DEPRECATED):null!=initializeState?function(initializeState){return freshSnapshot().map(initializeState).getStore_INTERNAL().getState()}(initializeState):makeEmptyStoreState());var mutableSource=useMemo((function(){return createMutableSource?createMutableSource(storeState,(function(){return storeState.current.currentTree.version})):null}),[createMutableSource,storeState]);return useEffect((function(){return function(){var _step7,_iterator7=_createForOfIteratorHelper(storeRef.current.getState().knownAtoms);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var atomKey=_step7.value;cleanUpNode(storeRef.current,atomKey)}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}}}),[]),React.createElement(AppContext.Provider,{value:storeRef},React.createElement(MutableSourceContext.Provider,{value:mutableSource},React.createElement(Batcher,{setNotifyBatcherOfChange:function(x){notifyBatcherOfChange.current=x}}),children))},sendEndOfBatchNotifications_FOR_TESTING:sendEndOfBatchNotifications};var Recoil_RecoilRoot_react=Object.freeze({__proto__:null}),AbstractRecoilValue$1=function AbstractRecoilValue(newKey){_classCallCheck(this,AbstractRecoilValue),_defineProperty(this,"key",void 0),this.key=newKey},RecoilState$1=function(_AbstractRecoilValue){_inherits(RecoilState,AbstractRecoilValue$1);var _super=_createSuper(RecoilState);function RecoilState(){return _classCallCheck(this,RecoilState),_super.apply(this,arguments)}return RecoilState}(),RecoilValueReadOnly$1=function(_AbstractRecoilValue2){_inherits(RecoilValueReadOnly,AbstractRecoilValue$1);var _super2=_createSuper(RecoilValueReadOnly);function RecoilValueReadOnly(){return _classCallCheck(this,RecoilValueReadOnly),_super2.apply(this,arguments)}return RecoilValueReadOnly}();module.exports={AbstractRecoilValue:AbstractRecoilValue$1,RecoilState:RecoilState$1,RecoilValueReadOnly:RecoilValueReadOnly$1,isRecoilValue:function(x){return x instanceof RecoilState$1||x instanceof RecoilValueReadOnly$1}};var Recoil_RecoilValue=Object.freeze({__proto__:null}),concatIterables=require("../util/Recoil_concatIterables"),filterIterable=require("../util/Recoil_filterIterable"),nullthrows$3=require("../util/Recoil_nullthrows"),batchUpdates$1=require("./Recoil_Batching").batchUpdates,_require2$2=require("./Recoil_FunctionalCore"),getDownstreamNodes$2=_require2$2.getDownstreamNodes,peekNodeInfo=_require2$2.peekNodeInfo,graph$1=require("./Recoil_Graph").graph,_require4$2=require("./Recoil_Node"),DEFAULT_VALUE$1=_require4$2.DEFAULT_VALUE,recoilValues$1=_require4$2.recoilValues,recoilValuesForKeys$1=_require4$2.recoilValuesForKeys,_require5$2=require("./Recoil_RecoilValueInterface"),AbstractRecoilValue$2=_require5$2.AbstractRecoilValue,getRecoilValueAsLoadable$1=_require5$2.getRecoilValueAsLoadable,setRecoilValue$1=_require5$2.setRecoilValue,setUnvalidatedRecoilValue$1=_require5$2.setUnvalidatedRecoilValue,_require6$1=require("./Recoil_State"),getNextTreeStateVersion$1=_require6$1.getNextTreeStateVersion,makeEmptyStoreState$1=_require6$1.makeEmptyStoreState,Snapshot=function(){function Snapshot(storeState){var _this=this;_classCallCheck(this,Snapshot),_defineProperty(this,"_store",void 0),_defineProperty(this,"getLoadable",(function(recoilValue){return getRecoilValueAsLoadable$1(_this._store,recoilValue)})),_defineProperty(this,"getPromise",(function(recoilValue){return _this.getLoadable(recoilValue).toPromise()})),_defineProperty(this,"getNodes_UNSTABLE",(function(opt){if(!0===(null==opt?void 0:opt.isModified)){if(!1===(null==opt?void 0:opt.isInitialized))return[];var state=_this._store.getState().currentTree;return recoilValuesForKeys$1(state.dirtyAtoms)}var knownAtoms=_this._store.getState().knownAtoms,knownSelectors=_this._store.getState().knownSelectors;return null==(null==opt?void 0:opt.isInitialized)?recoilValues$1.values():!0===opt.isInitialized?recoilValuesForKeys$1(concatIterables([_this._store.getState().knownAtoms,_this._store.getState().knownSelectors])):filterIterable(recoilValues$1.values(),(function(_ref){var key=_ref.key;return!knownAtoms.has(key)&&!knownSelectors.has(key)}))})),_defineProperty(this,"getDeps_UNSTABLE",(function(recoilValue){_this.getLoadable(recoilValue);var deps=_this._store.getGraph(_this._store.getState().currentTree.version).nodeDeps.get(recoilValue.key);return recoilValuesForKeys$1(null!=deps?deps:[])})),_defineProperty(this,"getSubscribers_UNSTABLE",(function(_ref2){var key=_ref2.key,state=_this._store.getState().currentTree,downstreamNodes=filterIterable(getDownstreamNodes$2(_this._store,state,new Set([key])),(function(nodeKey){return nodeKey!==key}));return{nodes:recoilValuesForKeys$1(downstreamNodes)}})),_defineProperty(this,"getInfo_UNSTABLE",(function(_ref3){var key=_ref3.key;return peekNodeInfo(_this._store,_this._store.getState().currentTree,key)})),_defineProperty(this,"map",(function(mapper){var mutableSnapshot=new MutableSnapshot(_this);return mapper(mutableSnapshot),cloneSnapshot(mutableSnapshot.getStore_INTERNAL())})),_defineProperty(this,"asyncMap",function(){var fn,_ref4=(fn=regeneratorRuntime.mark((function _callee(mapper){var mutableSnapshot;return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return mutableSnapshot=new MutableSnapshot(_this),_context.next=3,mapper(mutableSnapshot);case 3:return _context.abrupt("return",cloneSnapshot(mutableSnapshot.getStore_INTERNAL()));case 4:case"end":return _context.stop()}}),_callee)})),function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))});return function(_x){return _ref4.apply(this,arguments)}}()),this._store={getState:function(){return storeState},replaceState:function(replacer){storeState.currentTree=replacer(storeState.currentTree)},getGraph:function(version){var graphs=storeState.graphsByVersion;if(graphs.has(version))return nullthrows$3(graphs.get(version));var newGraph=graph$1();return graphs.set(version,newGraph),newGraph},subscribeToTransactions:function(){return{release:function(){}}},addTransactionMetadata:function(){throw new Error("Cannot subscribe to Snapshots")}}}return _createClass(Snapshot,[{key:"getStore_INTERNAL",value:function(){return this._store}},{key:"getID",value:function(){return this.getID_INTERNAL()}},{key:"getID_INTERNAL",value:function(){return this._store.getState().currentTree.stateID}}]),Snapshot}();function cloneStoreState(store,treeState){var bumpVersion=arguments.length>2&&void 0!==arguments[2]&&arguments[2],storeState=store.getState(),version=bumpVersion?getNextTreeStateVersion$1():treeState.version;return{currentTree:bumpVersion?{version:version,stateID:version,transactionMetadata:_objectSpread2({},treeState.transactionMetadata),dirtyAtoms:new Set(treeState.dirtyAtoms),atomValues:treeState.atomValues.clone(),nonvalidatedAtoms:treeState.nonvalidatedAtoms.clone()}:treeState,nextTree:null,previousTree:null,knownAtoms:new Set(storeState.knownAtoms),knownSelectors:new Set(storeState.knownSelectors),transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:(new Map).set(version,store.getGraph(treeState.version)),versionsUsedByComponent:new Map}}function cloneSnapshot(store){var version=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"current",storeState=store.getState(),treeState="current"===version?storeState.currentTree:nullthrows$3(storeState.previousTree);return new Snapshot(cloneStoreState(store,treeState))}var MutableSnapshot=function(_Snapshot){_inherits(MutableSnapshot,Snapshot);var _super=_createSuper(MutableSnapshot);function MutableSnapshot(snapshot){var _this2;return _classCallCheck(this,MutableSnapshot),_defineProperty(_assertThisInitialized(_this2=_super.call(this,cloneStoreState(snapshot.getStore_INTERNAL(),snapshot.getStore_INTERNAL().getState().currentTree,!0))),"set",(function(recoilState,newValueOrUpdater){var store=_this2.getStore_INTERNAL();batchUpdates$1((function(){setRecoilValue$1(store,recoilState,newValueOrUpdater)}))})),_defineProperty(_assertThisInitialized(_this2),"reset",(function(recoilState){return batchUpdates$1((function(){return setRecoilValue$1(_this2.getStore_INTERNAL(),recoilState,DEFAULT_VALUE$1)}))})),_defineProperty(_assertThisInitialized(_this2),"setUnvalidatedAtomValues_DEPRECATED",(function(values){var store=_this2.getStore_INTERNAL();batchUpdates$1((function(){var _step,_iterator=_createForOfIteratorHelper(values.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),k=_step$value[0],v=_step$value[1];setUnvalidatedRecoilValue$1(store,new AbstractRecoilValue$2(k),v)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}))})),_this2}return MutableSnapshot}();module.exports={Snapshot:Snapshot,MutableSnapshot:MutableSnapshot,freshSnapshot:function(initializeState){var snapshot=new Snapshot(makeEmptyStoreState$1());return null!=initializeState?snapshot.map(initializeState):snapshot},cloneSnapshot:cloneSnapshot};var Recoil_Snapshot=Object.freeze({__proto__:null}),_require$3=require("react"),useCallback=_require$3.useCallback,useEffect$1=_require$3.useEffect,useMemo$1=_require$3.useMemo,useRef$1=_require$3.useRef,useState$1=_require$3.useState,batchUpdates$2=require("../core/Recoil_Batching").batchUpdates,_require3$3=require("../core/Recoil_Node"),DEFAULT_VALUE$2=_require3$3.DEFAULT_VALUE,getNode$1=_require3$3.getNode,nodes$1=_require3$3.nodes,_require4$3=require("../core/Recoil_RecoilRoot.react"),useRecoilMutableSource$1=_require4$3.useRecoilMutableSource,useStoreRef$1=_require4$3.useStoreRef,_require6$2=(require("../core/Recoil_RecoilValue").isRecoilValue,require("../core/Recoil_RecoilValueInterface")),AbstractRecoilValue$3=_require6$2.AbstractRecoilValue,getRecoilValueAsLoadable$2=_require6$2.getRecoilValueAsLoadable,setRecoilValue$2=_require6$2.setRecoilValue,setRecoilValueLoadable$1=_require6$2.setRecoilValueLoadable,setUnvalidatedRecoilValue$2=_require6$2.setUnvalidatedRecoilValue,subscribeToRecoilValue$1=_require6$2.subscribeToRecoilValue,_require7$1=require("../core/Recoil_Snapshot"),cloneSnapshot$1=(_require7$1.Snapshot,_require7$1.cloneSnapshot),setByAddingToSet=require("../util/Recoil_CopyOnWrite").setByAddingToSet,differenceSets=require("../util/Recoil_differenceSets"),expectationViolation$2=require("../util/Recoil_expectationViolation"),filterMap=require("../util/Recoil_filterMap"),filterSet=require("../util/Recoil_filterSet"),gkx$1=require("../util/Recoil_gkx"),invariant=require("../util/Recoil_invariant"),mapMap=require("../util/Recoil_mapMap"),mergeMaps=require("../util/Recoil_mergeMaps"),_require9=require("../util/Recoil_mutableSource"),mutableSourceExists=_require9.mutableSourceExists,useMutableSource=_require9.useMutableSource,nullthrows$4=require("../util/Recoil_nullthrows"),recoverableViolation$2=require("../util/Recoil_recoverableViolation"),Tracing$2=require("../util/Recoil_Tracing"),useComponentName=require("../util/Recoil_useComponentName");function handleLoadable(loadable,atom,storeRef){if("hasValue"===loadable.state)return loadable.contents;if("loading"===loadable.state)throw new Promise((function(resolve){storeRef.current.getState().suspendedComponentResolvers.add(resolve)}));throw"hasError"===loadable.state?loadable.contents:new Error('Invalid value of loadable atom "'.concat(atom.key,'"'))}function useRecoilValueLoadable(recoilValue){return mutableSourceExists()?function(recoilValue){var storeRef=useStoreRef$1(),getLoadable=useCallback((function(){var store=storeRef.current,treeState=store.getState().currentTree;return getRecoilValueAsLoadable$2(store,recoilValue,treeState)}),[storeRef,recoilValue]),getLoadableWithTesting=useCallback((function(){return getLoadable()}),[getLoadable]),componentName=useComponentName(),subscribe=useCallback((function(_storeState,callback){var store=storeRef.current;return subscribeToRecoilValue$1(store,recoilValue,(function(){return Tracing$2.trace("RecoilValue subscription fired",recoilValue.key,(function(){if(!gkx$1("recoil_suppress_rerender_in_callback"))return callback();var newLoadable=getLoadable();prevLoadableRef.current.is(newLoadable)||callback()}))}),componentName).release}),[storeRef,recoilValue,componentName,getLoadable]),source=useRecoilMutableSource$1(),loadable=useMutableSource(source,getLoadableWithTesting,subscribe),prevLoadableRef=useRef$1(loadable);return useEffect$1((function(){prevLoadableRef.current=loadable})),loadable}(recoilValue):function(recoilValue){var storeRef=useStoreRef$1(),_useState4=_slicedToArray(useState$1([]),2),forceUpdate=(_useState4[0],_useState4[1]),componentName=useComponentName();useEffect$1((function(){var store=storeRef.current,storeState=store.getState(),subscription=subscribeToRecoilValue$1(store,recoilValue,(function(_state){Tracing$2.trace("RecoilValue subscription fired",recoilValue.key,(function(){var _prevLoadableRef$curr;if(!gkx$1("recoil_suppress_rerender_in_callback"))return forceUpdate([]);var newLoadable=getRecoilValueAsLoadable$2(store,recoilValue,store.getState().currentTree);(null===(_prevLoadableRef$curr=prevLoadableRef.current)||void 0===_prevLoadableRef$curr?void 0:_prevLoadableRef$curr.is(newLoadable))||forceUpdate(newLoadable)}))}),componentName);return Tracing$2.trace("initial update on subscribing",recoilValue.key,(function(){storeState.nextTree?store.getState().queuedComponentCallbacks_DEPRECATED.push(Tracing$2.wrap((function(){prevLoadableRef.current=null,forceUpdate([])}))):forceUpdate([])})),subscription.release}),[componentName,recoilValue,storeRef]);var loadable=getRecoilValueAsLoadable$2(storeRef.current,recoilValue),prevLoadableRef=useRef$1(loadable);return useEffect$1((function(){prevLoadableRef.current=loadable})),loadable}(recoilValue)}function useRecoilValue(recoilValue){var storeRef=useStoreRef$1();return handleLoadable(useRecoilValueLoadable(recoilValue),recoilValue,storeRef)}function useSetRecoilState(recoilState){var storeRef=useStoreRef$1();return useCallback((function(newValueOrUpdater){setRecoilValue$2(storeRef.current,recoilState,newValueOrUpdater)}),[storeRef,recoilState])}function useTransactionSubscription(callback){var storeRef=useStoreRef$1();useEffect$1((function(){return storeRef.current.subscribeToTransactions(callback).release}),[callback,storeRef])}function externallyVisibleAtomValuesInState(state){var atomValues=state.atomValues.toMap(),persistedAtomContentsValues=mapMap(filterMap(atomValues,(function(v,k){var persistence=getNode$1(k).persistence_UNSTABLE;return null!=persistence&&"none"!==persistence.type&&"hasValue"===v.state})),(function(v){return v.contents}));return mergeMaps(state.nonvalidatedAtoms.toMap(),persistedAtomContentsValues)}function useGotoRecoilSnapshot(){var storeRef=useStoreRef$1();return useCallback((function(snapshot){var _storeState$nextTree,storeState=storeRef.current.getState(),prev=null!==(_storeState$nextTree=storeState.nextTree)&&void 0!==_storeState$nextTree?_storeState$nextTree:storeState.currentTree,next=snapshot.getStore_INTERNAL().getState().currentTree;batchUpdates$2((function(){for(var keysToUpdate=new Set,_i=0,_arr=[prev.atomValues.keys(),next.atomValues.keys()];_i<_arr.length;_i++){var _step,_iterator=_createForOfIteratorHelper(_arr[_i]);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _prev$atomValues$get,_next$atomValues$get,key=_step.value;(null===(_prev$atomValues$get=prev.atomValues.get(key))||void 0===_prev$atomValues$get?void 0:_prev$atomValues$get.contents)!==(null===(_next$atomValues$get=next.atomValues.get(key))||void 0===_next$atomValues$get?void 0:_next$atomValues$get.contents)&&getNode$1(key).shouldRestoreFromSnapshots&&keysToUpdate.add(key)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}keysToUpdate.forEach((function(key){setRecoilValueLoadable$1(storeRef.current,new AbstractRecoilValue$3(key),next.atomValues.has(key)?nullthrows$4(next.atomValues.get(key)):DEFAULT_VALUE$2)})),storeRef.current.replaceState((function(state){return _objectSpread2(_objectSpread2({},state),{},{stateID:snapshot.getID_INTERNAL()})}))}))}),[storeRef])}var Sentinel=function Sentinel(){_classCallCheck(this,Sentinel)},SENTINEL=new Sentinel;module.exports={recoilComponentGetRecoilValueCount_FOR_TESTING:{current:0},useGotoRecoilSnapshot:useGotoRecoilSnapshot,useRecoilCallback:function(fn,deps){var storeRef=useStoreRef$1(),gotoSnapshot=useGotoRecoilSnapshot();return useCallback((function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var snapshot=cloneSnapshot$1(storeRef.current);function set(recoilState,newValueOrUpdater){setRecoilValue$2(storeRef.current,recoilState,newValueOrUpdater)}function reset(recoilState){setRecoilValue$2(storeRef.current,recoilState,DEFAULT_VALUE$2)}var ret=SENTINEL;return batchUpdates$2((function(){ret=fn({set:set,reset:reset,snapshot:snapshot,gotoSnapshot:gotoSnapshot}).apply(void 0,args)})),ret instanceof Sentinel&&invariant(!1),ret}),null!=deps?[].concat(_toConsumableArray(deps),[storeRef]):void 0)},useRecoilInterface:function(){var storeRef=useStoreRef$1(),_useState2=_slicedToArray(useState$1([]),2),forceUpdate=(_useState2[0],_useState2[1]),recoilValuesUsed=useRef$1(new Set);recoilValuesUsed.current=new Set;var previousSubscriptions=useRef$1(new Set),subscriptions=useRef$1(new Map),unsubscribeFrom=useCallback((function(key){var sub=subscriptions.current.get(key);sub&&(sub.release(),subscriptions.current.delete(key))}),[subscriptions]),componentName=useComponentName();return useEffect$1((function(){var store=storeRef.current;function updateState(_state,key){subscriptions.current.has(key)&&forceUpdate([])}differenceSets(recoilValuesUsed.current,previousSubscriptions.current).forEach((function(key){if(subscriptions.current.has(key))expectationViolation$2('Double subscription to RecoilValue "'.concat(key,'"'));else{var sub=subscribeToRecoilValue$1(store,new AbstractRecoilValue$3(key),(function(state){Tracing$2.trace("RecoilValue subscription fired",key,(function(){updateState(0,key)}))}),componentName);subscriptions.current.set(key,sub),Tracing$2.trace("initial update on subscribing",key,(function(){store.getState().nextTree?store.getState().queuedComponentCallbacks_DEPRECATED.push(Tracing$2.wrap((function(){updateState(store.getState(),key)}))):updateState(store.getState(),key)}))}})),differenceSets(previousSubscriptions.current,recoilValuesUsed.current).forEach((function(key){unsubscribeFrom(key)})),previousSubscriptions.current=recoilValuesUsed.current})),useEffect$1((function(){var subs=subscriptions.current;return function(){return subs.forEach((function(_,key){return unsubscribeFrom(key)}))}}),[unsubscribeFrom]),useMemo$1((function(){function useSetRecoilState(recoilState){return function(newValueOrUpdater){setRecoilValue$2(storeRef.current,recoilState,newValueOrUpdater)}}function useRecoilValueLoadable(recoilValue){return recoilValuesUsed.current.has(recoilValue.key)||(recoilValuesUsed.current=setByAddingToSet(recoilValuesUsed.current,recoilValue.key)),getRecoilValueAsLoadable$2(storeRef.current,recoilValue)}function useRecoilValue(recoilValue){return handleLoadable(useRecoilValueLoadable(recoilValue),recoilValue,storeRef)}return{getRecoilValue:useRecoilValue,getRecoilValueLoadable:useRecoilValueLoadable,getRecoilState:function(recoilState){return[useRecoilValue(recoilState),useSetRecoilState(recoilState)]},getRecoilStateLoadable:function(recoilState){return[useRecoilValueLoadable(recoilState),useSetRecoilState(recoilState)]},getSetRecoilState:useSetRecoilState,getResetRecoilState:function(recoilState){return function(){return setRecoilValue$2(storeRef.current,recoilState,DEFAULT_VALUE$2)}}}}),[recoilValuesUsed,storeRef])},useRecoilSnapshot:function(){var storeRef=useStoreRef$1(),_useState6=_slicedToArray(useState$1((function(){return cloneSnapshot$1(storeRef.current)})),2),snapshot=_useState6[0],setSnapshot=_useState6[1];return useTransactionSubscription(useCallback((function(store){return setSnapshot(cloneSnapshot$1(store))}),[])),snapshot},useRecoilState:function(recoilState){return[useRecoilValue(recoilState),useSetRecoilState(recoilState)]},useRecoilStateLoadable:function(recoilState){return[useRecoilValueLoadable(recoilState),useSetRecoilState(recoilState)]},useRecoilTransactionObserver:function(callback){useTransactionSubscription(useCallback((function(store){callback({snapshot:cloneSnapshot$1(store,"current"),previousSnapshot:cloneSnapshot$1(store,"previous")})}),[callback]))},useRecoilValue:useRecoilValue,useRecoilValueLoadable:useRecoilValueLoadable,useResetRecoilState:function(recoilState){var storeRef=useStoreRef$1();return useCallback((function(){setRecoilValue$2(storeRef.current,recoilState,DEFAULT_VALUE$2)}),[storeRef,recoilState])},useSetRecoilState:useSetRecoilState,useSetUnvalidatedAtomValues:function(){var storeRef=useStoreRef$1();return function(values){var transactionMetadata=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};batchUpdates$2((function(){storeRef.current.addTransactionMetadata(transactionMetadata),values.forEach((function(value,key){return setUnvalidatedRecoilValue$2(storeRef.current,new AbstractRecoilValue$3(key),value)}))}))}},useTransactionObservation_DEPRECATED:function(callback){useTransactionSubscription(useCallback((function(store){var previousTree=store.getState().previousTree,currentTree=store.getState().currentTree;previousTree||(recoverableViolation$2("Transaction subscribers notified without a previous tree being present -- this is a bug in Recoil","recoil"),previousTree=store.getState().currentTree);var atomValues=externallyVisibleAtomValuesInState(currentTree),previousAtomValues=externallyVisibleAtomValuesInState(previousTree),atomInfo=mapMap(nodes$1,(function(node){var _node$persistence_UNS,_node$persistence_UNS2,_node$persistence_UNS3,_node$persistence_UNS4;return{persistence_UNSTABLE:{type:null!==(_node$persistence_UNS=null===(_node$persistence_UNS2=node.persistence_UNSTABLE)||void 0===_node$persistence_UNS2?void 0:_node$persistence_UNS2.type)&&void 0!==_node$persistence_UNS?_node$persistence_UNS:"none",backButton:null!==(_node$persistence_UNS3=null===(_node$persistence_UNS4=node.persistence_UNSTABLE)||void 0===_node$persistence_UNS4?void 0:_node$persistence_UNS4.backButton)&&void 0!==_node$persistence_UNS3&&_node$persistence_UNS3}}})),modifiedAtoms=filterSet(currentTree.dirtyAtoms,(function(k){return atomValues.has(k)||previousAtomValues.has(k)}));callback({atomValues:atomValues,previousAtomValues:previousAtomValues,atomInfo:atomInfo,modifiedAtoms:modifiedAtoms,transactionMetadata:_objectSpread2({},currentTree.transactionMetadata)})}),[callback]))},useTransactionSubscription_DEPRECATED:useTransactionSubscription};var Recoil_Hooks=Object.freeze({__proto__:null}),setByAddingToSet$1=require("../util/Recoil_CopyOnWrite").setByAddingToSet,filterIterable$1=require("../util/Recoil_filterIterable"),mapIterable$1=require("../util/Recoil_mapIterable"),_require2$4=require("./Recoil_Node"),getNode$2=_require2$4.getNode,getNodeMaybe$2=_require2$4.getNodeMaybe,recoilValuesForKeys$2=_require2$4.recoilValuesForKeys,emptySet=Object.freeze(new Set),ReadOnlyRecoilValueError=function(_Error){_inherits(ReadOnlyRecoilValueError,_wrapNativeSuper(Error));var _super=_createSuper(ReadOnlyRecoilValueError);function ReadOnlyRecoilValueError(){return _classCallCheck(this,ReadOnlyRecoilValueError),_super.apply(this,arguments)}return ReadOnlyRecoilValueError}();function peekNodeLoadable(store,state,key){return getNode$2(key).peek(store,state)}function getDownstreamNodes$3(store,state,keys){for(var visitedNodes=new Set,visitingNodes=Array.from(keys),graph=store.getGraph(state.version),key=visitingNodes.pop();key;key=visitingNodes.pop()){var _graph$nodeToNodeSubs;visitedNodes.add(key);var _step,_iterator=_createForOfIteratorHelper(null!==(_graph$nodeToNodeSubs=graph.nodeToNodeSubscriptions.get(key))&&void 0!==_graph$nodeToNodeSubs?_graph$nodeToNodeSubs:emptySet);try{for(_iterator.s();!(_step=_iterator.n()).done;){var downstreamNode=_step.value;visitedNodes.has(downstreamNode)||visitingNodes.push(downstreamNode)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}return visitedNodes}module.exports={getNodeLoadable:function(store,state,key){return getNode$2(key).get(store,state)},peekNodeLoadable:peekNodeLoadable,setNodeValue:function(store,state,key,newValue){var node=getNode$2(key);if(null==node.set)throw new ReadOnlyRecoilValueError("Attempt to set read-only RecoilValue: ".concat(key));return node.set(store,state,newValue)},cleanUpNode:function(store,key){getNode$2(key).cleanUp(store)},setUnvalidatedAtomValue_DEPRECATED:function(state,key,newValue){var _node$invalidate,node=getNodeMaybe$2(key);return null==node||null===(_node$invalidate=node.invalidate)||void 0===_node$invalidate||_node$invalidate.call(node,state),_objectSpread2(_objectSpread2({},state),{},{atomValues:state.atomValues.clone().delete(key),nonvalidatedAtoms:state.nonvalidatedAtoms.clone().set(key,newValue),dirtyAtoms:setByAddingToSet$1(state.dirtyAtoms,key)})},peekNodeInfo:function(store,state,key){var _graph$nodeDeps$get,_storeState$nodeToCom,_storeState$nodeToCom2,storeState=store.getState(),graph=store.getGraph(state.version),type=storeState.knownAtoms.has(key)?"atom":storeState.knownSelectors.has(key)?"selector":void 0,downstreamNodes=filterIterable$1(getDownstreamNodes$3(store,state,new Set([key])),(function(nodeKey){return nodeKey!==key}));return{loadable:peekNodeLoadable(store,state,key),isActive:storeState.knownAtoms.has(key)||storeState.knownSelectors.has(key),isSet:"selector"!==type&&state.atomValues.has(key),isModified:state.dirtyAtoms.has(key),type:type,deps:recoilValuesForKeys$2(null!==(_graph$nodeDeps$get=graph.nodeDeps.get(key))&&void 0!==_graph$nodeDeps$get?_graph$nodeDeps$get:[]),subscribers:{nodes:recoilValuesForKeys$2(downstreamNodes),components:mapIterable$1(null!==(_storeState$nodeToCom=null===(_storeState$nodeToCom2=storeState.nodeToComponentSubscriptions.get(key))||void 0===_storeState$nodeToCom2?void 0:_storeState$nodeToCom2.values())&&void 0!==_storeState$nodeToCom?_storeState$nodeToCom:[],(function(_ref){return{name:_slicedToArray(_ref,1)[0]}}))}}},getDownstreamNodes:getDownstreamNodes$3};var peekNodeInfo$2=Object.freeze({__proto__:null}).peekNodeInfo,useStoreRef$2=Recoil_RecoilRoot_react.useStoreRef;var Recoil_useGetRecoilValueInfo=function(){var storeRef=useStoreRef$2();return function(_ref){var key=_ref.key;return peekNodeInfo$2(storeRef.current,storeRef.current.getState().currentTree,key)}},useMemo$2=react.useMemo,RecoilRoot$1=Recoil_RecoilRoot_react.RecoilRoot,useStoreRef$3=Recoil_RecoilRoot_react.useStoreRef;var Recoil_useRecoilBridgeAcrossReactRoots=function(){var store=useStoreRef$3().current;return useMemo$2((function(){return function(_ref){var children=_ref.children;return react.createElement(RecoilRoot$1,{store_INTERNAL:store},children)}}),[store])},_require$6=require("../adt/Recoil_Loadable"),loadableWithError=_require$6.loadableWithError,loadableWithPromise=_require$6.loadableWithPromise,loadableWithValue=_require$6.loadableWithValue,_require2$5=require("../core/Recoil_Node"),DEFAULT_VALUE$3=_require2$5.DEFAULT_VALUE,DefaultValue$2=_require2$5.DefaultValue,registerNode$1=_require2$5.registerNode,isRecoilValue$3=require("../core/Recoil_RecoilValue").isRecoilValue,_require4$4=require("../core/Recoil_RecoilValueInterface"),markRecoilValueModified$1=_require4$4.markRecoilValueModified,setRecoilValue$3=_require4$4.setRecoilValue,setRecoilValueLoadable$2=_require4$4.setRecoilValueLoadable,expectationViolation$3=(require("../util/Recoil_deepFreezeValue"),require("../util/Recoil_expectationViolation")),isPromise=require("../util/Recoil_isPromise"),nullthrows$5=require("../util/Recoil_nullthrows"),recoverableViolation$3=require("../util/Recoil_recoverableViolation"),selector=require("./Recoil_selector");function baseAtom(options){var key=options.key,persistence=options.persistence_UNSTABLE,defaultLoadable=isPromise(options.default)?loadableWithPromise(options.default.then((function(value){return defaultLoadable=loadableWithValue(value),{__key:key,__value:value}})).catch((function(error){throw defaultLoadable=loadableWithError(error),error}))):loadableWithValue(options.default),cachedAnswerForUnvalidatedValue=void 0,cleanupEffectsByStore=new Map;function initAtom(store,initState,trigger){if(!store.getState().knownAtoms.has(key)){if(store.getState().knownAtoms.add(key),"loading"===defaultLoadable.state){var notifyDefaultSubscribers=function(){var _store$getState$nextT3;(null!==(_store$getState$nextT3=store.getState().nextTree)&&void 0!==_store$getState$nextT3?_store$getState$nextT3:store.getState().currentTree).atomValues.has(key)||markRecoilValueModified$1(store,node)};defaultLoadable.contents.then(notifyDefaultSubscribers).catch(notifyDefaultSubscribers)}var initValue=DEFAULT_VALUE$3,pendingSetSelf=null;if(null!=options.effects_UNSTABLE){var _options$effects_UNST,_step,duringInit=!0,setSelf=function(effect){return function(valueOrUpdater){if(duringInit){var currentValue=initValue instanceof DefaultValue$2||isPromise(initValue)?"hasValue"===defaultLoadable.state?defaultLoadable.contents:DEFAULT_VALUE$3:initValue;initValue="function"==typeof valueOrUpdater?valueOrUpdater(currentValue):valueOrUpdater}else{if(isPromise(valueOrUpdater))throw new Error("Setting atoms to async values is not implemented.");"function"!=typeof valueOrUpdater&&(pendingSetSelf={effect:effect,value:valueOrUpdater}),setRecoilValue$3(store,node,"function"==typeof valueOrUpdater?function(currentValue){var newValue=valueOrUpdater(currentValue);return pendingSetSelf={effect:effect,value:newValue},newValue}:valueOrUpdater)}}},resetSelf=function(effect){return function(){return setSelf(effect)(DEFAULT_VALUE$3)}},onSet=function(effect){return function(handler){store.subscribeToTransactions((function(currentStore){var _pendingSetSelf3,_currentStore$getStat=currentStore.getState(),currentTree=_currentStore$getStat.currentTree,previousTree=_currentStore$getStat.previousTree;previousTree||(recoverableViolation$3("Transaction subscribers notified without a next tree being present -- this is a bug in Recoil","recoil"),previousTree=currentTree);var newLoadable=currentTree.atomValues.get(key);if(null==newLoadable||"hasValue"===newLoadable.state){var _previousTree$atomVal,_pendingSetSelf,_pendingSetSelf2,_newValue=null!=newLoadable?newLoadable.contents:DEFAULT_VALUE$3,oldLoadable=null!==(_previousTree$atomVal=previousTree.atomValues.get(key))&&void 0!==_previousTree$atomVal?_previousTree$atomVal:defaultLoadable,_oldValue="hasValue"===oldLoadable.state?oldLoadable.contents:DEFAULT_VALUE$3;(null===(_pendingSetSelf=pendingSetSelf)||void 0===_pendingSetSelf?void 0:_pendingSetSelf.effect)===effect&&(null===(_pendingSetSelf2=pendingSetSelf)||void 0===_pendingSetSelf2?void 0:_pendingSetSelf2.value)===_newValue||handler(_newValue,_oldValue)}(null===(_pendingSetSelf3=pendingSetSelf)||void 0===_pendingSetSelf3?void 0:_pendingSetSelf3.effect)===effect&&(pendingSetSelf=null)}),key)}},_iterator=_createForOfIteratorHelper(null!==(_options$effects_UNST=options.effects_UNSTABLE)&&void 0!==_options$effects_UNST?_options$effects_UNST:[]);try{for(_iterator.s();!(_step=_iterator.n()).done;){var effect=_step.value,cleanup=effect({node:node,trigger:trigger,setSelf:setSelf(effect),resetSelf:resetSelf(effect),onSet:onSet(effect)});null!=cleanup&&cleanupEffectsByStore.set(store,cleanup)}}catch(err){_iterator.e(err)}finally{_iterator.f()}duringInit=!1}if(!(initValue instanceof DefaultValue$2)){var _store$getState$nextT4,initLoadable=isPromise(initValue)?loadableWithPromise(function(store,promise){var wrappedPromise=promise.then((function(value){var _store$getState$nextT,_state$atomValues$get;return(null===(_state$atomValues$get=(null!==(_store$getState$nextT=store.getState().nextTree)&&void 0!==_store$getState$nextT?_store$getState$nextT:store.getState().currentTree).atomValues.get(key))||void 0===_state$atomValues$get?void 0:_state$atomValues$get.contents)===wrappedPromise&&setRecoilValue$3(store,node,value),{__key:key,__value:value}})).catch((function(error){var _store$getState$nextT2,_state$atomValues$get2;throw(null===(_state$atomValues$get2=(null!==(_store$getState$nextT2=store.getState().nextTree)&&void 0!==_store$getState$nextT2?_store$getState$nextT2:store.getState().currentTree).atomValues.get(key))||void 0===_state$atomValues$get2?void 0:_state$atomValues$get2.contents)===wrappedPromise&&setRecoilValueLoadable$2(store,node,loadableWithError(error)),error}));return wrappedPromise}(store,initValue)):loadableWithValue(initValue);initState.atomValues.set(key,initLoadable),null===(_store$getState$nextT4=store.getState().nextTree)||void 0===_store$getState$nextT4||_store$getState$nextT4.atomValues.set(key,initLoadable)}}}var node=registerNode$1({key:key,peek:function(_store,state){var _ref,_state$atomValues$get3,_cachedAnswerForUnval;return null!==(_ref=null!==(_state$atomValues$get3=state.atomValues.get(key))&&void 0!==_state$atomValues$get3?_state$atomValues$get3:null===(_cachedAnswerForUnval=cachedAnswerForUnvalidatedValue)||void 0===_cachedAnswerForUnval?void 0:_cachedAnswerForUnval[1])&&void 0!==_ref?_ref:defaultLoadable},get:function(store,state){if(initAtom(store,state,"get"),state.atomValues.has(key))return[new Map,nullthrows$5(state.atomValues.get(key))];if(state.nonvalidatedAtoms.has(key)){if(null!=cachedAnswerForUnvalidatedValue)return cachedAnswerForUnvalidatedValue;if(null==persistence)return expectationViolation$3("Tried to restore a persisted value for atom ".concat(key," but it has no persistence settings.")),[new Map,defaultLoadable];var nonvalidatedValue=state.nonvalidatedAtoms.get(key),validatorResult=persistence.validator(nonvalidatedValue,DEFAULT_VALUE$3),validatedValueLoadable=validatorResult instanceof DefaultValue$2?defaultLoadable:loadableWithValue(validatorResult);return cachedAnswerForUnvalidatedValue=[new Map,validatedValueLoadable]}return[new Map,defaultLoadable]},set:function(store,state,newValue){if(initAtom(store,state,"set"),state.atomValues.has(key)){var existing=nullthrows$5(state.atomValues.get(key));if("hasValue"===existing.state&&newValue===existing.contents)return[new Map,new Map]}else if(!state.nonvalidatedAtoms.has(key)&&newValue instanceof DefaultValue$2)return[new Map,new Map];return cachedAnswerForUnvalidatedValue=void 0,[new Map,(new Map).set(key,loadableWithValue(newValue))]},cleanUp:function(store){var _cleanupEffectsByStor;null===(_cleanupEffectsByStor=cleanupEffectsByStore.get(store))||void 0===_cleanupEffectsByStor||_cleanupEffectsByStor(),cleanupEffectsByStore.delete(store)},invalidate:function(){cachedAnswerForUnvalidatedValue=void 0},dangerouslyAllowMutability:options.dangerouslyAllowMutability,persistence_UNSTABLE:options.persistence_UNSTABLE?{type:options.persistence_UNSTABLE.type,backButton:options.persistence_UNSTABLE.backButton}:void 0,shouldRestoreFromSnapshots:!0});return node}function atom(options){var optionsDefault=options.default,restOptions=_objectWithoutProperties(options,["default"]);return isRecoilValue$3(optionsDefault)?function(options){var base=atom(_objectSpread2(_objectSpread2({},options),{},{default:DEFAULT_VALUE$3,persistence_UNSTABLE:void 0===options.persistence_UNSTABLE?void 0:_objectSpread2(_objectSpread2({},options.persistence_UNSTABLE),{},{validator:function(storedValue){return storedValue instanceof DefaultValue$2?storedValue:nullthrows$5(options.persistence_UNSTABLE).validator(storedValue,DEFAULT_VALUE$3)}}),effects_UNSTABLE:options.effects_UNSTABLE}));return selector({key:"".concat(options.key,"__withFallback"),get:function(_ref2){var baseValue=(0,_ref2.get)(base);return baseValue instanceof DefaultValue$2?options.default:baseValue},set:function(_ref3,newValue){return(0,_ref3.set)(base,newValue)},dangerouslyAllowMutability:options.dangerouslyAllowMutability})}(_objectSpread2(_objectSpread2({},restOptions),{},{default:optionsDefault})):baseAtom(_objectSpread2(_objectSpread2({},restOptions),{},{default:optionsDefault}))}module.exports=atom;var Recoil_atom=Object.freeze({__proto__:null}),cacheWithValueEquality=require("../caches/Recoil_cacheWithValueEquality"),_require$7=require("../core/Recoil_Node"),DEFAULT_VALUE$4=_require$7.DEFAULT_VALUE,DefaultValue$3=_require$7.DefaultValue,stableStringify=require("../util/Recoil_stableStringify"),atom$1=require("./Recoil_atom"),selectorFamily=require("./Recoil_selectorFamily");module.exports=function(options){var legacyAtom,atomCache=cacheWithValueEquality(),legacyAtomOptions={key:options.key,default:DEFAULT_VALUE$4,persistence_UNSTABLE:options.persistence_UNSTABLE};legacyAtom=atom$1(legacyAtomOptions);var atomFamilyDefault=selectorFamily({key:"".concat(options.key,"__atomFamily/Default"),get:function(param){return function(_ref){var legacyValue=(0,_ref.get)("function"==typeof legacyAtom?legacyAtom(param):legacyAtom);return legacyValue instanceof DefaultValue$3?"function"==typeof options.default?options.default(param):options.default:legacyValue}},dangerouslyAllowMutability:options.dangerouslyAllowMutability});return function(params){var _stableStringify,cachedAtom=atomCache.get(params);if(null!=cachedAtom)return cachedAtom;var newAtom=atom$1(_objectSpread2(_objectSpread2({},options),{},{key:"".concat(options.key,"__").concat(null!==(_stableStringify=stableStringify(params))&&void 0!==_stableStringify?_stableStringify:"void"),default:atomFamilyDefault(params),effects_UNSTABLE:"function"==typeof options.effects_UNSTABLE?options.effects_UNSTABLE(params):options.effects_UNSTABLE}));return atomCache=atomCache.set(params,newAtom),newAtom}};var Recoil_atomFamily=Object.freeze({__proto__:null}),LEAF=Symbol("ArrayKeyedMap"),emptyMap=new Map,ArrayKeyedMap=function(){function ArrayKeyedMap(existing){if(_classCallCheck(this,ArrayKeyedMap),_defineProperty(this,"_base",new Map),existing instanceof ArrayKeyedMap){var _step,_iterator=_createForOfIteratorHelper(existing.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),k=_step$value[0],v=_step$value[1];this.set(k,v)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else if(existing){var _step2,_iterator2=_createForOfIteratorHelper(existing);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_slicedToArray(_step2.value,2),_k=_step2$value[0],_v=_step2$value[1];this.set(_k,_v)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}return this}return _createClass(ArrayKeyedMap,[{key:"get",value:function(key){var ks=Array.isArray(key)?key:[key],map=this._base;return ks.forEach((function(k){var _map$get;map=null!==(_map$get=map.get(k))&&void 0!==_map$get?_map$get:emptyMap})),void 0===map?void 0:map.get(LEAF)}},{key:"set",value:function(key,value){var ks=Array.isArray(key)?key:[key],map=this._base,next=map;return ks.forEach((function(k){(next=map.get(k))||(next=new Map,map.set(k,next)),map=next})),next.set(LEAF,value),this}},{key:"delete",value:function(key){var ks=Array.isArray(key)?key:[key],map=this._base,next=map;return ks.forEach((function(k){(next=map.get(k))||(next=new Map,map.set(k,next)),map=next})),next.delete(LEAF),this}},{key:"entries",value:function(){var answer=[];return function recurse(level,prefix){level.forEach((function(v,k){k===LEAF?answer.push([prefix,v]):recurse(v,prefix.concat(k))}))}(this._base,[]),answer.values()}},{key:"toBuiltInMap",value:function(){return new Map(this.entries())}}]),ArrayKeyedMap}();module.exports={ArrayKeyedMap:ArrayKeyedMap};var ArrayKeyedMap$1=Object.freeze({__proto__:null}).ArrayKeyedMap;var Recoil_cacheWithReferenceEquality=function(){return new ArrayKeyedMap$1},isPromise$1=require("./Recoil_isPromise");function stringify(x,opt,key){if("string"==typeof x&&!x.includes('"')&&!x.includes("\\"))return'"'.concat(x,'"');switch(_typeof(x)){case"undefined":return"";case"boolean":return x?"true":"false";case"number":case"symbol":return String(x);case"string":return JSON.stringify(x);case"function":if(!0!==(null==opt?void 0:opt.allowFunctions))throw new Error("Attempt to serialize function in a Recoil cache key");return"__FUNCTION(".concat(x.name,")__")}if(null===x)return"null";var _JSON$stringify;if("object"!==_typeof(x))return null!==(_JSON$stringify=JSON.stringify(x))&&void 0!==_JSON$stringify?_JSON$stringify:"";if(isPromise$1(x))return"__PROMISE__";if(Array.isArray(x))return"[".concat(x.map((function(v,i){return stringify(v,opt,i.toString())})),"]");if("function"==typeof x.toJSON)return stringify(x.toJSON(key),opt,key);if(x instanceof Map){var _step,obj={},_iterator=_createForOfIteratorHelper(x);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),k=_step$value[0],v=_step$value[1];obj["string"==typeof k?k:stringify(k,opt)]=v}}catch(err){_iterator.e(err)}finally{_iterator.f()}return stringify(obj,opt,key)}return x instanceof Set?stringify(Array.from(x).sort((function(a,b){return stringify(a,opt).localeCompare(stringify(b,opt))})),opt,key):null!=x[Symbol.iterator]&&"function"==typeof x[Symbol.iterator]?stringify(Array.from(x),opt,key):"{".concat(Object.keys(x).filter((function(key){return void 0!==x[key]})).sort().map((function(key){return"".concat(stringify(key,opt),":").concat(stringify(x[key],opt,key))})).join(","),"}")}module.exports=function(x){var opt=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{allowFunctions:!1};return stringify(x,opt)};var Recoil_stableStringify=Object.freeze({__proto__:null});var Recoil_cacheWithValueEquality=function(){var map=new Map,cache={get:function(key){return map.get(Recoil_stableStringify(key))},set:function(key,value){return map.set(Recoil_stableStringify(key),value),cache},map:map};return cache},gks=new Map;function Recoil_gkx(gk){var _gks$get;return null!==(_gks$get=gks.get(gk))&&void 0!==_gks$get&&_gks$get}Recoil_gkx.setPass=function(gk){gks.set(gk,!0)},Recoil_gkx.setFail=function(gk){gks.set(gk,!1)};var executionId,Recoil_gkx_1=Recoil_gkx,_require$8=require("../adt/Recoil_Loadable"),loadableWithError$1=_require$8.loadableWithError,loadableWithPromise$1=_require$8.loadableWithPromise,loadableWithValue$1=_require$8.loadableWithValue,cacheMostRecent=require("../caches/Recoil_cacheMostRecent"),cacheWithReferenceEquality$1=require("../caches/Recoil_cacheWithReferenceEquality"),cacheWithValueEquality$2=require("../caches/Recoil_cacheWithValueEquality"),nodeCacheMostRecent=require("../caches/Recoil_nodeCacheMostRecent"),treeCacheReferenceEquality=require("../caches/Recoil_treeCacheReferenceEquality"),treeCacheValueEquality=require("../caches/Recoil_treeCacheValueEquality"),_require2$6=require("../core/Recoil_FunctionalCore"),getNodeLoadable$2=_require2$6.getNodeLoadable,peekNodeLoadable$1=_require2$6.peekNodeLoadable,setNodeValue$3=_require2$6.setNodeValue,saveDependencyMapToStore$2=require("../core/Recoil_Graph").saveDependencyMapToStore,_require4$5=require("../core/Recoil_Node"),DEFAULT_VALUE$5=_require4$5.DEFAULT_VALUE,RecoilValueNotReady$2=_require4$5.RecoilValueNotReady,registerNode$2=_require4$5.registerNode,isRecoilValue$4=require("../core/Recoil_RecoilValue").isRecoilValue,AbstractRecoilValue$4=require("../core/Recoil_RecoilValue").AbstractRecoilValue,setRecoilValueLoadable$3=require("../core/Recoil_RecoilValueInterface").setRecoilValueLoadable,isPromise$2=(require("../util/Recoil_deepFreezeValue"),require("../util/Recoil_isPromise")),nullthrows$6=require("../util/Recoil_nullthrows"),startPerfBlock=require("../util/Recoil_PerformanceTimings").startPerfBlock,emptySet$1=Object.freeze(new Set),dependencyStack=[],waitingStores=new Map,getNewExecutionId=(executionId=0,function(){return executionId++});module.exports=function(options){var key=options.key,get=options.get,cacheImplementation=options.cacheImplementation_UNSTABLE,set=null!=options.set?options.set:void 0,cache=cacheImplementation===cacheWithReferenceEquality$1?treeCacheReferenceEquality():cacheImplementation===cacheWithValueEquality$2?treeCacheValueEquality():cacheImplementation===cacheMostRecent?nodeCacheMostRecent():treeCacheReferenceEquality(),executionInfoMap=new Map;function getExecutionInfo(store){return executionInfoMap.has(store)||executionInfoMap.set(store,{depValuesDiscoveredSoFarDuringAsyncWork:null,latestLoadable:null,latestExecutionId:null,stateVersion:null}),nullthrows$6(executionInfoMap.get(store))}function initSelector(store){store.getState().knownSelectors.add(key)}function notifyStoreWhenAsyncSettles(store,loadable,executionId){if("loading"===loadable.state){var stores=waitingStores.get(executionId);null==stores&&waitingStores.set(executionId,stores=new Set),stores.add(store)}}function getCachedNodeLoadable(store,state,key){if(state.atomValues.has(key))return[new Map,nullthrows$6(state.atomValues.get(key))];var loadable=_slicedToArray(getNodeLoadable$2(store,state,key),2)[1],isKeyPointingToSelector=store.getState().knownSelectors.has(key);return"loading"!==loadable.state&&isKeyPointingToSelector&&state.atomValues.set(key,loadable),[new Map,loadable]}function wrapPendingDependencyPromise(store,promise,state,existingDeps,executionId){return promise.then((function(resolvedDep){var resolvedDepKey=resolvedDep.__key,depValue=resolvedDep.__value;null!=resolvedDepKey&&state.atomValues.set(resolvedDepKey,loadableWithValue$1(depValue));var _evaluateSelectorGett2=_slicedToArray(evaluateSelectorGetter(store,state,executionId),2),loadable=_evaluateSelectorGett2[0],depValues=_evaluateSelectorGett2[1];if(isLatestExecution(store,executionId)&&updateExecutionInfoDepValues(depValues,store,executionId),maybeFreezeLoadableContents(loadable),"loading"!==loadable.state&&(setCache(state,depValuesToDepRoute(depValues),loadable),setLoadableInStoreToNotifyDeps(store,loadable,executionId)),"hasError"===loadable.state)throw loadable.contents;return"hasValue"===loadable.state?{__value:loadable.contents,__key:key}:loadable.contents})).catch((function(error){var loadable=loadableWithError$1(error);throw setCache(state,depValuesToDepRoute(existingDeps),loadableWithError$1(error)),setLoadableInStoreToNotifyDeps(store,loadable,executionId),error}))}function setLoadableInStoreToNotifyDeps(store,loadable,executionId){isLatestExecution(store,executionId)&&(setExecutionInfo(loadable,store),function(newLoadable,executionId){var stores=waitingStores.get(executionId);if(void 0!==stores){var _step,_iterator=_createForOfIteratorHelper(stores);try{for(_iterator.s();!(_step=_iterator.n()).done;){var store=_step.value;setRecoilValueLoadable$3(store,new AbstractRecoilValue$4(key),newLoadable)}}catch(err){_iterator.e(err)}finally{_iterator.f()}waitingStores.delete(executionId)}}(loadable,executionId))}function setDepsInStore(store,state,deps,executionId){var _store$getState,_store$getState$curre,_store$getState2,_store$getState2$next,_store$getState$nextT,_store$getState3,_store$getState3$next;(isLatestExecution(store,executionId)||state.version===(null===(_store$getState=store.getState())||void 0===_store$getState||null===(_store$getState$curre=_store$getState.currentTree)||void 0===_store$getState$curre?void 0:_store$getState$curre.version)||state.version===(null===(_store$getState2=store.getState())||void 0===_store$getState2||null===(_store$getState2$next=_store$getState2.nextTree)||void 0===_store$getState2$next?void 0:_store$getState2$next.version))&&saveDependencyMapToStore$2(new Map([[key,deps]]),store,null!==(_store$getState$nextT=null===(_store$getState3=store.getState())||void 0===_store$getState3||null===(_store$getState3$next=_store$getState3.nextTree)||void 0===_store$getState3$next?void 0:_store$getState3$next.version)&&void 0!==_store$getState$nextT?_store$getState$nextT:store.getState().currentTree.version)}function setNewDepInStore(store,state,deps,newDepKey,executionId){deps.add(newDepKey),setDepsInStore(store,state,deps,executionId)}function evaluateSelectorGetter(store,state,executionId){var result,loadable,endPerfBlock=startPerfBlock(key),depValues=new Map,deps=new Set;function getRecoilValue(recoilValue){var depKey=recoilValue.key;setNewDepInStore(store,state,deps,depKey,executionId);var depLoadable=_slicedToArray(getCachedNodeLoadable(store,state,depKey),2)[1];if(depValues.set(depKey,depLoadable),"hasValue"===depLoadable.state)return depLoadable.contents;throw depLoadable.contents}setDepsInStore(store,state,deps,executionId);try{result=get({get:getRecoilValue}),result=isRecoilValue$4(result)?getRecoilValue(result):result,isPromise$2(result)?result=function(store,promise,state,depValues,executionId){return promise.then((function(value){var loadable=loadableWithValue$1(value);return setCache(state,depValuesToDepRoute(depValues),loadable),setLoadableInStoreToNotifyDeps(store,loadable,executionId),{__value:value,__key:key}})).catch((function(errorOrPromise){if(isLatestExecution(store,executionId)&&updateExecutionInfoDepValues(depValues,store,executionId),isPromise$2(errorOrPromise))return wrapPendingDependencyPromise(store,errorOrPromise,state,depValues,executionId);var loadable=loadableWithError$1(errorOrPromise);throw setCache(state,depValuesToDepRoute(depValues),loadable),setLoadableInStoreToNotifyDeps(store,loadable,executionId),errorOrPromise}))}(store,result,state,depValues,executionId).finally(endPerfBlock):endPerfBlock()}catch(errorOrDepPromise){isPromise$2(result=errorOrDepPromise)?result=wrapPendingDependencyPromise(store,result,state,depValues,executionId).finally(endPerfBlock):endPerfBlock()}return maybeFreezeLoadableContents(loadable=result instanceof Error?loadableWithError$1(result):isPromise$2(result)?loadableWithPromise$1(result):loadableWithValue$1(result)),[loadable,depValues]}function depValuesToDepRoute(depValues){return Array.from(depValues.entries()).map((function(_ref){var _ref2=_slicedToArray(_ref,2);return[_ref2[0],_ref2[1].contents]}))}function getValFromRunningNewExecutionAndUpdatedDeps(store,state){var newExecutionId=getNewExecutionId(),_evaluateSelectorGett4=_slicedToArray(evaluateSelectorGetter(store,state,newExecutionId),2),loadable=_evaluateSelectorGett4[0],newDepValues=_evaluateSelectorGett4[1];return setExecutionInfo(loadable,store,newDepValues,newExecutionId,state),function(state,depRoute,loadable){"loading"!==loadable.state&&setCache(state,depRoute,loadable)}(state,depValuesToDepRoute(newDepValues),loadable),notifyStoreWhenAsyncSettles(store,loadable,newExecutionId),loadable}function getSelectorValAndUpdatedDeps(store,state){var cachedVal=function(store,state){var _store$getGraph$nodeD;if(state.atomValues.has(key))return state.atomValues.get(key);var deps=new Set(null!==(_store$getGraph$nodeD=store.getGraph(state.version).nodeDeps.get(key))&&void 0!==_store$getGraph$nodeD?_store$getGraph$nodeD:emptySet$1),executionInfo=getExecutionInfo(store);return setDepsInStore(store,state,deps,executionInfo.latestExecutionId),cache.get((function(nodeKey){return _slicedToArray(getCachedNodeLoadable(store,state,nodeKey),2)[1].contents}),{onCacheHit:function(nodeKey){nodeKey!==key&&setNewDepInStore(store,state,deps,nodeKey,executionInfo.latestExecutionId)}})}(store,state);if(null!=cachedVal)return setExecutionInfo(cachedVal,store),cachedVal;var inProgressExecutionInfo=function(store,state){var _Array$from$find,_ref3=null!==(_Array$from$find=Array.from(executionInfoMap.entries()).find((function(_ref5){var executionInfo=_slicedToArray(_ref5,2)[1];return null!=executionInfo.latestLoadable&&null!=executionInfo.latestExecutionId&&!function(store,state){var _executionInfo$depVal,_mapOfCheckedVersions,executionInfo=getExecutionInfo(store),oldDepValues=null!==(_executionInfo$depVal=executionInfo.depValuesDiscoveredSoFarDuringAsyncWork)&&void 0!==_executionInfo$depVal?_executionInfo$depVal:new Map,cachedDepValuesCheckedForThisVersion=Array((null!==(_mapOfCheckedVersions=mapOfCheckedVersions.get(state.version))&&void 0!==_mapOfCheckedVersions?_mapOfCheckedVersions:new Map).entries()),isCachedVersionSame=mapOfCheckedVersions.has(state.version)&&cachedDepValuesCheckedForThisVersion.length===oldDepValues.size&&cachedDepValuesCheckedForThisVersion.every((function(_ref7){var _ref8=_slicedToArray(_ref7,2),nodeKey=_ref8[0],nodeVal=_ref8[1];return oldDepValues.get(nodeKey)===nodeVal}));if(null==oldDepValues||state.version===executionInfo.stateVersion||isCachedVersionSame)return!1;return mapOfCheckedVersions.set(state.version,new Map(oldDepValues)),Array.from(oldDepValues).some((function(_ref9){var _ref10=_slicedToArray(_ref9,2),nodeKey=_ref10[0],oldVal=_ref10[1],loadable=_slicedToArray(getCachedNodeLoadable(store,state,nodeKey),2)[1];return loadable.contents!==oldVal.contents&&!("loading"===oldVal.state&&"loading"!==loadable.state)}))}(store,state)})))&&void 0!==_Array$from$find?_Array$from$find:[];return _slicedToArray(_ref3,2)[1]}(store,state);if(inProgressExecutionInfo){var executionInfo=inProgressExecutionInfo;return notifyStoreWhenAsyncSettles(store,nullthrows$6(executionInfo.latestLoadable),nullthrows$6(executionInfo.latestExecutionId)),nullthrows$6(executionInfo.latestLoadable)}return getValFromRunningNewExecutionAndUpdatedDeps(store,state)}var mapOfCheckedVersions=new Map;function setExecutionInfo(loadable,store,depValues,newExecutionId,state){var executionInfo=getExecutionInfo(store);"loading"===loadable.state?(executionInfo.depValuesDiscoveredSoFarDuringAsyncWork=depValues,executionInfo.latestExecutionId=newExecutionId,executionInfo.latestLoadable=loadable,executionInfo.stateVersion=null==state?void 0:state.version):(executionInfo.depValuesDiscoveredSoFarDuringAsyncWork=null,executionInfo.latestExecutionId=null,executionInfo.latestLoadable=null,executionInfo.stateVersion=null)}function updateExecutionInfoDepValues(depValues,store,executionId){var executionInfo=getExecutionInfo(store);isLatestExecution(store,executionId)&&(executionInfo.depValuesDiscoveredSoFarDuringAsyncWork=depValues)}function isLatestExecution(store,executionId){return executionId===getExecutionInfo(store).latestExecutionId}function maybeFreezeLoadableContents(loadable){"loading"!==loadable.state&&loadable.contents}function setCache(state,cacheRoute,loadable){state.atomValues.set(key,loadable),cache.set(cacheRoute,loadable)}function detectCircularDependencies(fn){if(dependencyStack.includes(key)){var message="Recoil selector has circular dependencies: ".concat(dependencyStack.slice(dependencyStack.indexOf(key)).join("  "));return loadableWithError$1(new Error(message))}dependencyStack.push(key);try{return fn()}finally{dependencyStack.pop()}}function myPeek(store,state){return cache.get((function(nodeKey){var peek=peekNodeLoadable$1(store,state,nodeKey);return null==peek?void 0:peek.contents}))}function myGet(store,state){return initSelector(store),[new Map,detectCircularDependencies((function(){return getSelectorValAndUpdatedDeps(store,state)}))]}function invalidate(state){state.atomValues.delete(key)}if(null!=set){return registerNode$2({key:key,peek:myPeek,get:myGet,set:function(store,state,newValue){initSelector(store);var syncSelectorSetFinished=!1,dependencyMap=new Map,writes=new Map;function getRecoilValue(_ref11){var key=_ref11.key;if(syncSelectorSetFinished)throw new Error("Recoil: Async selector sets are not currently supported.");var loadable=_slicedToArray(getCachedNodeLoadable(store,state,key),2)[1];if("hasValue"===loadable.state)return loadable.contents;throw"loading"===loadable.state?new RecoilValueNotReady$2(key):loadable.contents}function setRecoilState(recoilState,valueOrUpdater){if(syncSelectorSetFinished)throw new Error("Recoil: Async selector sets are not currently supported.");var newValue="function"==typeof valueOrUpdater?valueOrUpdater(getRecoilValue(recoilState)):valueOrUpdater;_slicedToArray(setNodeValue$3(store,state,recoilState.key,newValue),2)[1].forEach((function(v,k){return writes.set(k,v)}))}var ret=set({set:setRecoilState,get:getRecoilValue,reset:function(recoilState){setRecoilState(recoilState,DEFAULT_VALUE$5)}},newValue);if(void 0!==ret)throw isPromise$2(ret)?new Error("Recoil: Async selector sets are not currently supported."):new Error("Recoil: selector set should be a void function.");return syncSelectorSetFinished=!0,[dependencyMap,writes]},cleanUp:function(){},invalidate:invalidate,dangerouslyAllowMutability:options.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1})}return registerNode$2({key:key,peek:myPeek,get:myGet,cleanUp:function(){},invalidate:invalidate,dangerouslyAllowMutability:options.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1})};var Recoil_selector_NEW=Object.freeze({__proto__:null}),_require$9=require("../adt/Recoil_Loadable"),loadableWithError$2=_require$9.loadableWithError,loadableWithPromise$2=_require$9.loadableWithPromise,loadableWithValue$2=_require$9.loadableWithValue,cacheWithReferenceEquality$2=require("../caches/Recoil_cacheWithReferenceEquality"),_require2$7=require("../core/Recoil_FunctionalCore"),getNodeLoadable$3=_require2$7.getNodeLoadable,peekNodeLoadable$2=_require2$7.peekNodeLoadable,setNodeValue$4=_require2$7.setNodeValue,_require3$6=require("../core/Recoil_Graph"),addToDependencyMap=_require3$6.addToDependencyMap,mergeDepsIntoDependencyMap=_require3$6.mergeDepsIntoDependencyMap,saveDependencyMapToStore$3=_require3$6.saveDependencyMapToStore,_require4$6=require("../core/Recoil_Node"),DEFAULT_VALUE$6=_require4$6.DEFAULT_VALUE,RecoilValueNotReady$3=_require4$6.RecoilValueNotReady,registerNode$3=_require4$6.registerNode,AbstractRecoilValue$5=require("../core/Recoil_RecoilValue").AbstractRecoilValue,_require6$4=require("../core/Recoil_RecoilValueInterface"),getRecoilValueAsLoadable$3=_require6$4.getRecoilValueAsLoadable,isRecoilValue$5=_require6$4.isRecoilValue,setRecoilValueLoadable$4=_require6$4.setRecoilValueLoadable,isPromise$3=(require("../util/Recoil_deepFreezeValue"),require("../util/Recoil_isPromise")),nullthrows$7=require("../util/Recoil_nullthrows"),startPerfBlock$1=require("../util/Recoil_PerformanceTimings").startPerfBlock,emptySet$2=Object.freeze(new Set);function cacheKeyFromDepValues(depValues){var _step,answer=[],_iterator=_createForOfIteratorHelper(Array.from(depValues.keys()).sort());try{for(_iterator.s();!(_step=_iterator.n()).done;){var key=_step.value,loadable=nullthrows$7(depValues.get(key));answer.push(key),answer.push(loadable.state),answer.push(loadable.contents)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return answer}var waitingStores$1=new Map;module.exports=function(options){var key=options.key,get=options.get,cacheImplementation=options.cacheImplementation_UNSTABLE,set=null!=options.set?options.set:void 0,cache=null!=cacheImplementation?cacheImplementation:cacheWithReferenceEquality$2();function initSelector(store){store.getState().knownSelectors.add(key)}function letStoreBeNotifiedWhenAsyncSettles(store,loadable){if("loading"===loadable.state){var stores=waitingStores$1.get(loadable);void 0===stores&&waitingStores$1.set(loadable,stores=new Set),stores.add(store)}}function notifyStoresOfSettledAsync(originalLoadable,newLoadable){var stores=waitingStores$1.get(originalLoadable);if(void 0!==stores){var _step2,_iterator2=_createForOfIteratorHelper(stores);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var store=_step2.value;setRecoilValueLoadable$4(store,new AbstractRecoilValue$5(key),newLoadable)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}waitingStores$1.delete(originalLoadable)}}function getFromCacheOrEvaluate(store,state){var _store$getGraph$nodeD,dependencyMap=new Map,currentDeps=null!==(_store$getGraph$nodeD=store.getGraph(state.version).nodeDeps.get(key))&&void 0!==_store$getGraph$nodeD?_store$getGraph$nodeD:emptySet$2,cacheKey=cacheKeyFromDepValues(new Map(Array.from(currentDeps).sort().map((function(depKey){var _getNodeLoadable2=_slicedToArray(getNodeLoadable$3(store,state,depKey),2),deps=_getNodeLoadable2[0],loadable=_getNodeLoadable2[1];return mergeDepsIntoDependencyMap(deps,dependencyMap),saveDependencyMapToStore$3(dependencyMap,store,state.version),[depKey,loadable]})))),cached=cache.get(cacheKey);if(null!=cached)return letStoreBeNotifiedWhenAsyncSettles(store,cached),[dependencyMap,cached];var _evaluateSelectorFunc=function(store,state){var endPerfBlock=startPerfBlock$1(key),depValues=new Map,dependencyMap=new Map;function getRecoilValue(_ref){var depKey=_ref.key;addToDependencyMap(key,depKey,dependencyMap);var _getNodeLoadable4=_slicedToArray(getNodeLoadable$3(store,state,depKey),2),deps=_getNodeLoadable4[0],loadable=_getNodeLoadable4[1];if(depValues.set(depKey,loadable),mergeDepsIntoDependencyMap(deps,dependencyMap),saveDependencyMapToStore$3(dependencyMap,store,state.version),"hasValue"===loadable.state)return loadable.contents;throw loadable.contents}try{var loadable,output=get({get:getRecoilValue}),result=isRecoilValue$5(output)?getRecoilValue(output):output;return isPromise$3(result)?loadable=loadableWithPromise$2(result.finally(endPerfBlock)):(endPerfBlock(),loadable=loadableWithValue$2(result)),[dependencyMap,loadable,depValues]}catch(errorOrDepPromise){var _loadable;return void 0!==errorOrDepPromise.then?_loadable=loadableWithPromise$2(errorOrDepPromise.then((function(){var loadable=getRecoilValueAsLoadable$3(store,new AbstractRecoilValue$5(key));if("hasError"===loadable.state)throw loadable.contents;return loadable.contents})).finally(endPerfBlock)):(endPerfBlock(),_loadable=loadableWithError$2(errorOrDepPromise)),[dependencyMap,_loadable,depValues]}}(store,state),_evaluateSelectorFunc2=_slicedToArray(_evaluateSelectorFunc,3),deps=_evaluateSelectorFunc2[0],loadable=_evaluateSelectorFunc2[1],newDepValues=_evaluateSelectorFunc2[2];mergeDepsIntoDependencyMap(deps,dependencyMap),saveDependencyMapToStore$3(dependencyMap,store,state.version);var newCacheKey=cacheKeyFromDepValues(newDepValues);return letStoreBeNotifiedWhenAsyncSettles(store,loadable),function(state,cacheKey,loadable){"loading"!==loadable.state||loadable.contents.then((function(result){var newLoadable=loadableWithValue$2(result);return cache=cache.set(cacheKey,newLoadable),notifyStoresOfSettledAsync(loadable,newLoadable),result})).catch((function(error){if(isPromise$3(error))return error;var newLoadable=loadableWithError$2(error);return cache=cache.set(cacheKey,newLoadable),notifyStoresOfSettledAsync(loadable,newLoadable),error})),cache=cache.set(cacheKey,loadable),"loading"!==loadable.state&&state.atomValues.set(key,loadable)}(state,newCacheKey,loadable),[dependencyMap,loadable]}function myPeek(store,state){var _store$getGraph$nodeD2,_step3,currentDeps=null!==(_store$getGraph$nodeD2=store.getGraph(state.version).nodeDeps.get(key))&&void 0!==_store$getGraph$nodeD2?_store$getGraph$nodeD2:emptySet$2,depValues=new Map(Array.from(currentDeps).sort().map((function(depKey){return[depKey,peekNodeLoadable$2(store,state,depKey)]}))),cacheDepValues=new Map,_iterator3=_createForOfIteratorHelper(depValues.entries());try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_slicedToArray(_step3.value,2),depKey=_step3$value[0],depValue=_step3$value[1];if(null==depValue)return;cacheDepValues.set(depKey,depValue)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}var cacheKey=cacheKeyFromDepValues(cacheDepValues);return cache.get(cacheKey)}function invalidate(state){state.atomValues.delete(key)}function myGet(store,state){initSelector(store);var cached=state.atomValues.get(key);return void 0!==cached?[new Map,cached]:getFromCacheOrEvaluate(store,state)}if(null!=set){return registerNode$3({key:key,peek:myPeek,get:myGet,set:function(store,state,newValue){initSelector(store);var syncSelectorSetFinished=!1,dependencyMap=new Map,writes=new Map;function getRecoilValue(_ref2){var key=_ref2.key;if(syncSelectorSetFinished)throw new Error("Recoil: Async selector sets are not currently supported.");var _getNodeLoadable6=_slicedToArray(getNodeLoadable$3(store,state,key),2),deps=_getNodeLoadable6[0],loadable=_getNodeLoadable6[1];if(mergeDepsIntoDependencyMap(deps,dependencyMap),"hasValue"===loadable.state)return loadable.contents;throw"loading"===loadable.state?new RecoilValueNotReady$3(key):loadable.contents}function setRecoilState(recoilState,valueOrUpdater){if(syncSelectorSetFinished)throw new Error("Recoil: Async selector sets are not currently supported.");var newValue="function"==typeof valueOrUpdater?valueOrUpdater(getRecoilValue(recoilState)):valueOrUpdater,_setNodeValue2=_slicedToArray(setNodeValue$4(store,state,recoilState.key,newValue),2),deps=_setNodeValue2[0],upstreamWrites=_setNodeValue2[1];mergeDepsIntoDependencyMap(deps,dependencyMap),upstreamWrites.forEach((function(v,k){return writes.set(k,v)}))}var ret=set({set:setRecoilState,get:getRecoilValue,reset:function(recoilState){setRecoilState(recoilState,DEFAULT_VALUE$6)}},newValue);if(void 0!==ret)throw isPromise$3(ret)?new Error("Recoil: Async selector sets are not currently supported."):new Error("Recoil: selector set should be a void function.");return syncSelectorSetFinished=!0,[dependencyMap,writes]},invalidate:invalidate,cleanUp:function(){},dangerouslyAllowMutability:options.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1})}return registerNode$3({key:key,peek:myPeek,get:myGet,invalidate:invalidate,cleanUp:function(){},dangerouslyAllowMutability:options.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1})};var Recoil_selector_OLD=Object.freeze({__proto__:null}),Recoil_selector=Recoil_gkx_1("recoil_async_selector_refactor")?Recoil_selector_NEW:Recoil_selector_OLD,nextIndex=0;var Recoil_selectorFamily=function(options){var _options$cacheImpleme,_options$cacheImpleme2,selectorCache=null!==(_options$cacheImpleme=null===(_options$cacheImpleme2=options.cacheImplementationForParams_UNSTABLE)||void 0===_options$cacheImpleme2?void 0:_options$cacheImpleme2.call(options))&&void 0!==_options$cacheImpleme?_options$cacheImpleme:Recoil_cacheWithValueEquality();return function(params){var _stableStringify,_options$cacheImpleme3,cachedSelector=selectorCache.get(params);if(null!=cachedSelector)return cachedSelector;var newSelector,myKey="".concat(options.key,"__selectorFamily/").concat(null!==(_stableStringify=Recoil_stableStringify(params,{allowFunctions:!0}))&&void 0!==_stableStringify?_stableStringify:"void","/").concat(nextIndex++),myGet=function(callbacks){return options.get(params)(callbacks)},myCacheImplementation=null===(_options$cacheImpleme3=options.cacheImplementation_UNSTABLE)||void 0===_options$cacheImpleme3?void 0:_options$cacheImpleme3.call(options);if(null!=options.set){var set=options.set;newSelector=Recoil_selector({key:myKey,get:myGet,set:function(callbacks,newValue){return set(params)(callbacks,newValue)},cacheImplementation_UNSTABLE:myCacheImplementation,dangerouslyAllowMutability:options.dangerouslyAllowMutability})}else newSelector=Recoil_selector({key:myKey,get:myGet,cacheImplementation_UNSTABLE:myCacheImplementation,dangerouslyAllowMutability:options.dangerouslyAllowMutability});return selectorCache=selectorCache.set(params,newSelector),newSelector}},constantSelector=Recoil_selectorFamily({key:"__constant",get:function(constant){return function(){return constant}},cacheImplementationForParams_UNSTABLE:Recoil_cacheWithReferenceEquality});var Recoil_constSelector=function(constant){return constantSelector(constant)},throwingSelector=Recoil_selectorFamily({key:"__error",get:function(message){return function(){throw new Error(message)}},cacheImplementationForParams_UNSTABLE:Recoil_cacheWithReferenceEquality});var Recoil_errorSelector=function(message){return throwingSelector(message)};var Recoil_readOnlySelector=function(atom){return atom},_require$a=require("../adt/Recoil_Loadable"),loadableWithError$3=_require$a.loadableWithError,loadableWithPromise$3=_require$a.loadableWithPromise,loadableWithValue$3=_require$a.loadableWithValue,gkx$2=require("../util/Recoil_gkx"),isPromise$4=require("../util/Recoil_isPromise"),selectorFamily$2=require("./Recoil_selectorFamily");function concurrentRequests(getRecoilValue,deps){var _step,results=Array(deps.length).fill(void 0),exceptions=Array(deps.length).fill(void 0),_iterator=_createForOfIteratorHelper(deps.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),i=_step$value[0],dep=_step$value[1];try{results[i]=getRecoilValue(dep)}catch(e){exceptions[i]=e}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return[results,exceptions]}function isError(exp){return null!=exp&&!isPromise$4(exp)}function unwrapDependencies(dependencies){return Array.isArray(dependencies)?dependencies:Object.getOwnPropertyNames(dependencies).map((function(key){return dependencies[key]}))}function getValueFromLoadablePromiseResult(result){return null!=result&&"object"===_typeof(result)&&result.hasOwnProperty("__value")?result.__value:result}function wrapResults(dependencies,results){return Array.isArray(dependencies)?results:Object.getOwnPropertyNames(dependencies).reduce((function(out,key,idx){return _objectSpread2(_objectSpread2({},out),{},_defineProperty({},key,results[idx]))}),{})}function wrapLoadables(dependencies,results,exceptions){return wrapResults(dependencies,exceptions.map((function(exception,idx){return null==exception?loadableWithValue$3(results[idx]):isPromise$4(exception)?loadableWithPromise$3(exception):loadableWithError$3(exception)})))}var waitForNone=selectorFamily$2({key:"__waitForNone",get:function(dependencies){return function(_ref){var _concurrentRequests2=_slicedToArray(concurrentRequests(_ref.get,unwrapDependencies(dependencies)),2),results=_concurrentRequests2[0],exceptions=_concurrentRequests2[1];return wrapLoadables(dependencies,results,exceptions)}}}),waitForAny=selectorFamily$2({key:"__waitForAny",get:function(dependencies){return function(_ref2){var _concurrentRequests4=_slicedToArray(concurrentRequests(_ref2.get,unwrapDependencies(dependencies)),2),results=_concurrentRequests4[0],exceptions=_concurrentRequests4[1];if(exceptions.some((function(exp){return null==exp})))return wrapLoadables(dependencies,results,exceptions);if(exceptions.every(isError))throw exceptions.find(isError);if(gkx$2("recoil_async_selector_refactor"))return new Promise((function(resolve,reject){var _step2,_iterator2=_createForOfIteratorHelper(exceptions.entries());try{var _loop=function(){var _step2$value=_slicedToArray(_step2.value,2),i=_step2$value[0],exp=_step2$value[1];isPromise$4(exp)&&exp.then((function(result){results[i]=getValueFromLoadablePromiseResult(result),exceptions[i]=null,resolve(wrapLoadables(dependencies,results,exceptions))})).catch((function(error){exceptions[i]=error,exceptions.every(isError)&&reject(exceptions[0])}))};for(_iterator2.s();!(_step2=_iterator2.n()).done;)_loop()}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}));throw new Promise((function(resolve,reject){var _step3,_iterator3=_createForOfIteratorHelper(exceptions.entries());try{var _loop2=function(){var _step3$value=_slicedToArray(_step3.value,2),i=_step3$value[0],exp=_step3$value[1];isPromise$4(exp)&&exp.then((function(result){results[i]=result,exceptions[i]=null,resolve(wrapLoadables(dependencies,results,exceptions))})).catch((function(error){exceptions[i]=error,exceptions.every(isError)&&reject(exceptions[0])}))};for(_iterator3.s();!(_step3=_iterator3.n()).done;)_loop2()}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}))}}}),waitForAll=selectorFamily$2({key:"__waitForAll",get:function(dependencies){return function(_ref3){var _concurrentRequests6=_slicedToArray(concurrentRequests(_ref3.get,unwrapDependencies(dependencies)),2),results=_concurrentRequests6[0],exceptions=_concurrentRequests6[1];if(exceptions.every((function(exp){return null==exp})))return wrapResults(dependencies,results);var error=exceptions.find(isError);if(null!=error)throw error;if(gkx$2("recoil_async_selector_refactor"))return Promise.all(exceptions).then((function(exceptionResults){return wrapResults(dependencies,(syncResults=results,asyncResults=exceptionResults,asyncResults.map((function(result,idx){return void 0===result?syncResults[idx]:result}))).map(getValueFromLoadablePromiseResult));var syncResults,asyncResults}));throw Promise.all(exceptions).then((function(results){return wrapResults(dependencies,results)}))}}}),noWait=selectorFamily$2({key:"__noWait",get:function(dependency){return function(_ref4){var get=_ref4.get;try{return loadableWithValue$3(get(dependency))}catch(exception){return isPromise$4(exception)?loadableWithPromise$3(exception):loadableWithError$3(exception)}}}});module.exports={waitForNone:waitForNone,waitForAny:waitForAny,waitForAll:waitForAll,noWait:noWait};var Recoil_WaitFor=Object.freeze({__proto__:null}),batchUpdates$3=Recoil_Batching_batchUpdates,setBatcher$1=Recoil_Batching_setBatcher,DefaultValue$4=Recoil_Node.DefaultValue,RecoilRoot$2=Recoil_RecoilRoot_react.RecoilRoot,isRecoilValue$6=Recoil_RecoilValue.isRecoilValue,freshSnapshot$2=Recoil_Snapshot.freshSnapshot,useGotoRecoilSnapshot$1=Recoil_Hooks.useGotoRecoilSnapshot,useRecoilCallback$1=Recoil_Hooks.useRecoilCallback,useRecoilSnapshot$1=Recoil_Hooks.useRecoilSnapshot,useRecoilState$1=Recoil_Hooks.useRecoilState,useRecoilStateLoadable$1=Recoil_Hooks.useRecoilStateLoadable,useRecoilTransactionObserver$1=Recoil_Hooks.useRecoilTransactionObserver,useRecoilValue$1=Recoil_Hooks.useRecoilValue,useRecoilValueLoadable$1=Recoil_Hooks.useRecoilValueLoadable,useResetRecoilState$1=Recoil_Hooks.useResetRecoilState,useSetRecoilState$1=Recoil_Hooks.useSetRecoilState,useSetUnvalidatedAtomValues$1=Recoil_Hooks.useSetUnvalidatedAtomValues,useTransactionObservation_DEPRECATED$1=Recoil_Hooks.useTransactionObservation_DEPRECATED,noWait$1=Recoil_WaitFor.noWait,waitForAll$1=Recoil_WaitFor.waitForAll,waitForAny$1=Recoil_WaitFor.waitForAny,waitForNone$1=Recoil_WaitFor.waitForNone,Recoil_index={DefaultValue:DefaultValue$4,RecoilRoot:RecoilRoot$2,useRecoilBridgeAcrossReactRoots_UNSTABLE:Recoil_useRecoilBridgeAcrossReactRoots,atom:Recoil_atom,selector:Recoil_selector,atomFamily:Recoil_atomFamily,selectorFamily:Recoil_selectorFamily,constSelector:Recoil_constSelector,errorSelector:Recoil_errorSelector,readOnlySelector:Recoil_readOnlySelector,useRecoilValue:useRecoilValue$1,useRecoilValueLoadable:useRecoilValueLoadable$1,useRecoilState:useRecoilState$1,useRecoilStateLoadable:useRecoilStateLoadable$1,useSetRecoilState:useSetRecoilState$1,useResetRecoilState:useResetRecoilState$1,useGetRecoilValueInfo_UNSTABLE:Recoil_useGetRecoilValueInfo,useRecoilCallback:useRecoilCallback$1,useGotoRecoilSnapshot:useGotoRecoilSnapshot$1,useRecoilSnapshot:useRecoilSnapshot$1,useRecoilTransactionObserver_UNSTABLE:useRecoilTransactionObserver$1,useTransactionObservation_UNSTABLE:useTransactionObservation_DEPRECATED$1,useSetUnvalidatedAtomValues_UNSTABLE:useSetUnvalidatedAtomValues$1,noWait:noWait$1,waitForNone:waitForNone$1,waitForAny:waitForAny$1,waitForAll:waitForAll$1,isRecoilValue:isRecoilValue$6,batchUpdates:batchUpdates$3,setBatcher:setBatcher$1,snapshot_UNSTABLE:freshSnapshot$2};export default Recoil_index;
